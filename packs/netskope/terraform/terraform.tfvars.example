# =============================================================================
# Netskope Hardening Code Pack - Example Variables
# How to Harden (howtoharden.com)
#
# Copy this file to terraform.tfvars and fill in your values.
# NEVER commit terraform.tfvars to version control (contains secrets).
# =============================================================================

# -----------------------------------------------------------------------------
# Required: Profile Level
# -----------------------------------------------------------------------------

# Hardening profile level (1 = Baseline, 2 = Hardened, 3 = Maximum Security)
profile_level = 1

# -----------------------------------------------------------------------------
# Required: Netskope Provider Configuration
# -----------------------------------------------------------------------------

# Netskope tenant API v2 endpoint
netskope_server_url = "https://your-tenant.goskope.com/api/v2"

# Netskope REST API v2 token (keep secret)
netskope_api_key = "your-api-key-here"

# Netskope tenant base URL (without /api/v2)
netskope_tenant_url = "https://your-tenant.goskope.com"

# -----------------------------------------------------------------------------
# Section 1.1: Admin Console SSO (optional - leave empty to skip)
# -----------------------------------------------------------------------------

# admin_sso_idp_entity_id  = "https://idp.example.com/saml/metadata"
# admin_sso_idp_sso_url    = "https://idp.example.com/saml/sso"
# admin_sso_idp_certificate = "base64-encoded-certificate"

# -----------------------------------------------------------------------------
# Section 1.2: Tenant Hardening
# -----------------------------------------------------------------------------

# Session timeout in minutes (15 for L1, 10 for L2/L3)
session_timeout_minutes = 15

# L2+: IP allowlist for admin console access
# admin_ip_allowlist = ["203.0.113.0/24", "198.51.100.0/24"]

# -----------------------------------------------------------------------------
# Section 2.1: Application Visibility
# -----------------------------------------------------------------------------

# Cloud Confidence Index thresholds
cci_high_risk_threshold   = 50
cci_medium_risk_threshold = 70

# -----------------------------------------------------------------------------
# Section 2.2: Real-Time Protection Policies
# -----------------------------------------------------------------------------

block_unsanctioned_apps  = true
block_personal_instances = true

# -----------------------------------------------------------------------------
# Section 2.3: API Protection (L2+)
# -----------------------------------------------------------------------------

# api_protection_apps = ["Microsoft 365", "Google Workspace", "Slack", "Box"]
# api_scan_frequency  = "continuous"

# -----------------------------------------------------------------------------
# Section 3.1: DLP Profiles
# -----------------------------------------------------------------------------

dlp_credit_card_enabled = true
dlp_ssn_enabled         = true
dlp_api_keys_enabled    = true

# Custom regex patterns for DLP detection
# dlp_custom_patterns = ["PROJ-[0-9]{6}", "INTERNAL-[A-Z]{3}-[0-9]+"]

# -----------------------------------------------------------------------------
# Section 4.1: Malware Protection
# -----------------------------------------------------------------------------

# Requires SSE Professional or Enterprise license
sandbox_enabled = true

# File types to submit for sandbox analysis
# sandbox_file_types = ["exe", "dll", "pdf", "doc", "docx", "xls", "xlsx", "ppt", "pptx", "zip", "rar"]

# -----------------------------------------------------------------------------
# Section 4.2: Threat Protection Policies (L2+)
# -----------------------------------------------------------------------------

# block_newly_registered_domains = true
# block_uncategorized_sites      = false
# enable_behavior_analytics      = true

# -----------------------------------------------------------------------------
# Section 5.1: Steering Configuration
# -----------------------------------------------------------------------------

# Steering mode: all_traffic, web_traffic, or cloud_apps
steering_mode = "all_traffic"

# Certificate-pinned domains to exclude from SSL inspection
# cert_pinned_domains = ["banking-app.example.com", "health-portal.example.com"]

# Fail-close mode (L3 forces this to true regardless)
fail_close = false

# -----------------------------------------------------------------------------
# Section 5.2: Client Deployment
# -----------------------------------------------------------------------------

client_auto_update = true

# -----------------------------------------------------------------------------
# Section 6.1: Logging and Alerts
# -----------------------------------------------------------------------------

# SIEM integration: splunk, sentinel, syslog, or none
siem_type = "none"

# siem_endpoint = "https://splunk.example.com:8088"
# siem_token    = "your-hec-token-here"

alert_on_dlp_violations    = true
alert_on_malware           = true
alert_on_policy_violations = true
alert_on_admin_changes     = true
