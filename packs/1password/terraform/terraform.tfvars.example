# =============================================================================
# 1Password Hardening Code Pack - Example Variable Values
# How to Harden (howtoharden.com)
#
# Copy this file to terraform.tfvars and fill in your values.
# NEVER commit terraform.tfvars to version control -- it contains secrets.
#
# Usage:
#   cp terraform.tfvars.example terraform.tfvars
#   # Edit terraform.tfvars with your values
#   terraform plan
#   terraform apply
# =============================================================================


# -----------------------------------------------------------------------------
# Profile Level
# 1 = Baseline (L1) -- essential controls for all organizations
# 2 = Hardened (L2) -- adds firewall rules, SCIM, sharing restrictions
# 3 = Maximum Security (L3) -- strictest controls for regulated industries
# -----------------------------------------------------------------------------
profile_level = 1


# -----------------------------------------------------------------------------
# 1Password Provider Configuration
# -----------------------------------------------------------------------------

# 1Password Service Account token for Terraform provider authentication.
# Create at: Settings > Developer > Service Accounts
# WARNING: This is a sensitive value. Use environment variables in production:
#   export TF_VAR_op_service_account_token="ops_..."
op_service_account_token = ""

# 1Password Connect server URL (leave empty for Service Account auth)
# Only required if using 1Password Connect Server deployment.
# op_connect_url = "https://connect.yourcompany.com"


# -----------------------------------------------------------------------------
# Section 1.1: SSO Configuration
# Configure SSO via Admin Console first, then enter IdP details here
# for documentation and verification purposes.
# -----------------------------------------------------------------------------

# IdP SSO URL (e.g., from Okta, Azure AD, Google Workspace)
# idp_sso_url = "https://yourcompany.okta.com/app/1password/sso/saml"

# IdP Entity ID
# idp_entity_id = "https://yourcompany.okta.com/1password"

# IdP X.509 certificate (PEM-encoded) -- use environment variable:
#   export TF_VAR_idp_certificate="$(cat idp-cert.pem)"
# idp_certificate = ""


# -----------------------------------------------------------------------------
# Section 1.2: SCIM Provisioning (L2+ only)
# Deploy SCIM bridge first, then configure here.
# Only applied when profile_level >= 2.
# -----------------------------------------------------------------------------

# SCIM bridge URL (e.g., https://scim.yourcompany.com)
# scim_bridge_url = "https://scim.yourcompany.com"

# SCIM bearer token -- use environment variable:
#   export TF_VAR_scim_bearer_token="your-scim-token"
# scim_bearer_token = ""


# -----------------------------------------------------------------------------
# Section 2.1: Account Password Policy
# Minimum master password length by profile level:
#   L1: 10, L2: 12, L3: 14
# -----------------------------------------------------------------------------
master_password_min_length = 14


# -----------------------------------------------------------------------------
# Section 2.2: Firewall Rules (L2+ only)
# ISO 3166-1 alpha-2 country codes.
# Only applied when profile_level >= 2.
# -----------------------------------------------------------------------------
allowed_countries = ["US", "CA", "GB"]
denied_countries  = ["CN", "RU", "KP", "IR"]

# Corporate IP CIDRs for L3 IP allowlisting
# allowed_ip_cidrs = [
#   "203.0.113.0/24",    # Office egress
#   "198.51.100.0/24",   # VPN egress
# ]


# -----------------------------------------------------------------------------
# Section 3.2: Item Sharing Policies (L2+ only)
# Only applied when profile_level >= 2.
# -----------------------------------------------------------------------------
allow_item_sharing      = true
allow_guest_sharing     = false
share_link_expiry_hours = 72


# -----------------------------------------------------------------------------
# Section 4.1: Audit Logging / SIEM Integration
# Configure Events API streaming to your SIEM platform.
# -----------------------------------------------------------------------------

# SIEM webhook endpoint
# siem_endpoint = "https://your-siem.example.com/api/events"

# 1Password Events API bearer token -- use environment variable:
#   export TF_VAR_events_api_token="your-events-api-token"
# events_api_token = ""
