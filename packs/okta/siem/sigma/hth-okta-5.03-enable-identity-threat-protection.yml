title: Okta Identity Threat Protection - High or Critical Risk Threat Detected
id: d0e6f4a7-1b5c-4d29-e8a6-c4b0d2f39e75
status: test
description: |
    Detects high and critical risk threats identified by Okta Identity Threat Protection
    (ITP). These represent active session anomalies, impossible travel detections, or
    credential compromise intelligence that require immediate investigation. ITP evaluates
    session risk continuously and these events indicate the highest confidence threat
    signals from Okta's behavioral analytics engine.
    This corresponds to HTH Okta control hth-okta-5.03-enable-identity-threat-protection (section 5.3, L2).
references:
    - https://howtoharden.com/guides/okta/
    - https://developer.okta.com/docs/reference/api/system-log/
    - https://attack.mitre.org/techniques/T1078/
author: How to Harden
date: 2026/02/13
tags:
    - attack.initial_access
    - attack.t1078
logsource:
    product: okta
    service: okta
detection:
    selection_event:
        eventType:
            - 'security.threat.detected'
            - 'security.session.risk_change'
    selection_risk:
        debugContext.debugData.riskLevel:
            - 'HIGH'
            - 'CRITICAL'
    condition: selection_event and selection_risk
fields:
    - actor.displayName
    - client.ipAddress
    - outcome.result
    - debugContext.debugData.riskLevel
    - debugContext.debugData.riskReasons
    - published
falsepositives:
    - Okta ITP false positives during initial tuning period
    - Legitimate user behavior that triggers anomaly detection before baseline stabilizes
level: critical
