title: Okta Password Recovery via Weak Factor (SMS/Voice/Question)
id: 22cce2c6-4228-5fb9-8e79-042d5d266927
status: test
description: |
    Detects password recovery attempts using weak factors (SMS, voice call, or
    security question) that should be disabled after hardening. Any occurrence
    after hardening indicates configuration drift or bypass. Investigate
    immediately and verify recovery factor policy settings.
    This corresponds to HTH Okta control okta-weak-recovery-method (section 1.10, L1).
references:
    - https://howtoharden.com/guides/okta/
    - https://developer.okta.com/docs/reference/api/system-log/
author: How to Harden
date: 2026/02/13
tags:
    - attack.initial_access
    - attack.t1078.004
logsource:
    product: okta
    service: okta
detection:
    selection:
        eventType: 'user.account.reset_password'
        debugContext.debugData.factor:
            - 'SMS'
            - 'CALL'
            - 'QUESTION'
    condition: selection
fields:
    - actor.displayName
    - client.ipAddress
    - outcome.result
    - published
falsepositives:
    - Recovery attempts during migration period before weak factors are fully disabled
level: high
