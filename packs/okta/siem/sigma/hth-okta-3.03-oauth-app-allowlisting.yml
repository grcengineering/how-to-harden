title: Okta OAuth Consent Grant to Third-Party Application
id: 8a3c7e91-4b2d-4f1a-9c6e-d5a8b3f07e24
status: test
description: |
    Detects when users grant OAuth consent to third-party applications. Malicious apps
    can request broad scopes to access organizational data through consent phishing attacks.
    This corresponds to HTH Okta control hth-okta-3.03-oauth-app-allowlisting (section 3.3, L2).
references:
    - https://howtoharden.com/guides/okta/
    - https://developer.okta.com/docs/reference/api/system-log/
    - https://attack.mitre.org/techniques/T1566/002/
author: How to Harden
date: 2026/02/13
tags:
    - attack.initial_access
    - attack.t1566.002
logsource:
    product: okta
    service: okta
# HTH Guide Excerpt: begin detection
detection:
    selection:
        eventType:
            - 'app.oauth2.consent.grant'
            - 'app.oauth2.as.consent.grant'
    condition: selection
fields:
    - actor.displayName
    - actor.alternateId
    - target.displayName
    - debugContext.debugData.requestedScopes
    - client.ipAddress
    - published
# HTH Guide Excerpt: end detection
falsepositives:
    - Legitimate OAuth consent grants for approved business applications
level: medium
