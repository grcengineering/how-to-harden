id: "okta-1.4"
vendor: "okta"
title: "Configure Password Policy"
section: "1.4"
profile_level: 1
severity: "high"
guide_url: "https://howtoharden.com/guides/okta/#14-configure-password-policy"
description: >
  Configure comprehensive password policies with appropriate complexity, age, and history
  requirements. Enforce minimum length of 15 characters, require all character types, set
  maximum password age to 60 days, minimum age to 24 hours, and maintain history of 5
  passwords to prevent reuse and rapid cycling.
compliance:
  nist_800_53: ["IA-5(1)"]
  disa_stig: ["V-273195", "V-273196", "V-273197", "V-273198", "V-273199", "V-273200", "V-273201", "V-273208", "V-273209"]
audit:
  - id: "password-min-length"
    description: "Verify password minimum length is at least 15 characters"
    api:
      method: GET
      endpoint: "/api/v1/policies?type=PASSWORD"
      check: '[.[] | select(.status == "ACTIVE") | .settings.password.complexity.minLength >= 15] | all'
    expected: true
  - id: "password-complexity"
    description: "Verify all character type requirements are enabled (upper, lower, number, symbol)"
    api:
      method: GET
      endpoint: "/api/v1/policies?type=PASSWORD"
      check: '[.[] | select(.status == "ACTIVE") | .settings.password.complexity | (.minUpperCase >= 1 and .minLowerCase >= 1 and .minNumber >= 1 and .minSymbol >= 1)] | all'
    expected: true
  - id: "password-age-settings"
    description: "Verify max password age is 60 days or less and min age is at least 24 hours"
    api:
      method: GET
      endpoint: "/api/v1/policies?type=PASSWORD"
      check: '[.[] | select(.status == "ACTIVE") | .settings.password.age | (.maxAgeDays <= 60 and .minAgeMinutes >= 1440)] | all'
    expected: true
  - id: "password-history"
    description: "Verify password history enforces at least 5 previous passwords"
    api:
      method: GET
      endpoint: "/api/v1/policies?type=PASSWORD"
      check: '[.[] | select(.status == "ACTIVE") | .settings.password.age.historyCount >= 5] | all'
    expected: true
remediate:
  api:
    - description: "Update password policy with DISA STIG-compliant complexity and age settings"
      method: PUT
      endpoint: "/api/v1/policies/${POLICY_ID}"
      body:
        settings:
          password:
            complexity:
              minLength: 15
              minLowerCase: 1
              minUpperCase: 1
              minNumber: 1
              minSymbol: 1
            age:
              maxAgeDays: 60
              minAgeMinutes: 1440
              historyCount: 5
      condition: "!password-min-length"
  terraform:
    resources:
      - type: "okta_policy_password"
        name: "hardened_password"
        config:
          name: "Hardened Password Policy"
          status: "ACTIVE"
          priority: 1
          password_min_length: 15
          password_min_lowercase: 1
          password_min_uppercase: 1
          password_min_number: 1
          password_min_symbol: 1
          password_max_age_days: 60
          password_min_age_minutes: 1440
          password_history_count: 5
tags: ["password", "complexity", "authentication", "disa-stig"]
