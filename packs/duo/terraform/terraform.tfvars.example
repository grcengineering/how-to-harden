# =============================================================================
# HTH Duo Security Code Pack - Example Variable Values
# How to Harden (howtoharden.com)
#
# Copy this file to terraform.tfvars and fill in your values.
# NEVER commit terraform.tfvars to version control -- it contains secrets.
#
# Usage:
#   cp terraform.tfvars.example terraform.tfvars
#   # Edit terraform.tfvars with your values
#   terraform plan
#   terraform apply
# =============================================================================


# -----------------------------------------------------------------------------
# Profile Level
# 1 = Baseline (L1) -- essential controls for all organizations
# 2 = Hardened (L2) -- adds phishing-resistant MFA, trusted endpoints, tiered policies
# 3 = Maximum Security (L3) -- strictest controls for regulated industries
# -----------------------------------------------------------------------------
profile_level = 1


# -----------------------------------------------------------------------------
# Cisco ISE Provider Configuration
# ISE manages network access and device admin policies that integrate with Duo.
# -----------------------------------------------------------------------------

# ISE admin URL (e.g., "https://ise.example.com")
ise_url = "https://ise.example.com"

# ISE admin username with ERS API access
ise_username = "admin"

# ISE admin password
# WARNING: Use environment variables in production:
#   export TF_VAR_ise_password="your-password"
ise_password = ""

# Allow insecure TLS (only for lab environments)
ise_insecure = false


# -----------------------------------------------------------------------------
# Duo Admin API Configuration
# Required for Duo-native settings (policies, user management, logging).
# Generate at: Duo Admin Panel > Applications > Admin API
# WARNING: Use environment variables in production:
#   export TF_VAR_duo_secret_key="your-skey"
#   export TF_VAR_duo_integration_key="your-ikey"
# -----------------------------------------------------------------------------

# Duo Admin API hostname (e.g., "api-XXXXXXXX.duosecurity.com")
duo_api_hostname = "api-XXXXXXXX.duosecurity.com"

# Duo Admin API integration key (ikey)
duo_integration_key = ""

# Duo Admin API secret key (skey)
duo_secret_key = ""


# -----------------------------------------------------------------------------
# Section 1.1: Admin Account Security
# Maximum number of Owner-role admin accounts (recommended: 2)
# -----------------------------------------------------------------------------
admin_role_limit_owners = 2


# -----------------------------------------------------------------------------
# Section 2.1: Global Policy
# Action for new (unenrolled) users: "DENY" (recommended) or "ENROLL"
# -----------------------------------------------------------------------------
global_policy_new_user_action = "DENY"


# -----------------------------------------------------------------------------
# Section 2.3: Phishing-Resistant MFA (L2+ only)
# These settings only apply when profile_level >= 2
# -----------------------------------------------------------------------------

# Enable Verified Duo Push (number matching)
verified_push_enabled = true

# Disable SMS passcodes (L2+ recommended)
disable_sms_passcodes = false

# Disable phone callback (L2+ recommended)
disable_phone_callback = false


# -----------------------------------------------------------------------------
# Section 2.4: Authorized Networks (L2+ only)
# Corporate network CIDRs for network-aware Duo policies
# Only applied when profile_level >= 2
# -----------------------------------------------------------------------------
authorized_networks_cidrs = [
  # "203.0.113.0/24",    # Office egress
  # "198.51.100.0/24",   # VPN egress
]

# Always require MFA from authorized networks (recommended: true)
authorized_networks_require_mfa = true


# -----------------------------------------------------------------------------
# Section 3.1: Inactive Account Management
# Number of days before an account is flagged as inactive
# -----------------------------------------------------------------------------
inactive_days_threshold = 90


# -----------------------------------------------------------------------------
# Section 3.2: User Enrollment
# Enrollment link expiration in hours (24-72 recommended)
# -----------------------------------------------------------------------------
enrollment_link_expiry_hours = 48


# -----------------------------------------------------------------------------
# Section 4.1: Trusted Endpoints (L2+ only)
# Requires Duo Advantage or Premier plan + device management solution
# Only applied when profile_level >= 2
# -----------------------------------------------------------------------------

# Enable device trust verification
trusted_endpoints_enabled = false

# Block untrusted devices (true = strict, false = allow with warning)
block_untrusted_devices = false


# -----------------------------------------------------------------------------
# Section 5.1: Application Security - ISE Policy Sets
# Names for ISE policy sets created for Duo integration
# -----------------------------------------------------------------------------

# ISE identity source name for Duo MFA
duo_ise_identity_source_name = "Duo-MFA"

# ISE network access policy set name
duo_ise_policy_set_name = "Duo-MFA-Protected-Access"


# -----------------------------------------------------------------------------
# Section 5.2: Windows Logon / RDP
# Configure Duo for Windows Logon and Remote Desktop access
# -----------------------------------------------------------------------------

# Fail mode: "CLOSED" (block if Duo unreachable) or "OPEN" (allow if unreachable)
rdp_fail_mode = "CLOSED"

# Enable offline access (limited logins when Duo cloud is unreachable)
rdp_offline_access_enabled = false

# Offline access expiration in hours (24-72 recommended)
rdp_offline_expiry_hours = 48

# Maximum offline logins allowed
rdp_offline_max_logins = 5


# -----------------------------------------------------------------------------
# Section 6.1: Logging and SIEM
# Duo Admin API log export and Trust Monitor configuration
# -----------------------------------------------------------------------------

# Enable SIEM integration via Admin API log export
siem_integration_enabled = true

# Enable Trust Monitor anomaly detection (requires Advantage/Premier)
trust_monitor_enabled = false


# -----------------------------------------------------------------------------
# Section 6.3: Session Hijacking Protection (L2+ only)
# Session timeout and re-authentication settings
# Only applied when profile_level >= 2
# -----------------------------------------------------------------------------

# Session timeout in minutes
session_timeout_minutes = 60

# Require re-authentication for sensitive actions
reauthentication_for_sensitive_actions = false
