# =============================================================================
# Databricks Hardening Code Pack - Example Variable Values
# How to Harden (howtoharden.com)
#
# Copy this file to terraform.tfvars and fill in your values.
# NEVER commit terraform.tfvars to version control -- it contains secrets.
#
# Usage:
#   cp terraform.tfvars.example terraform.tfvars
#   # Edit terraform.tfvars with your values
#   terraform plan
#   terraform apply
# =============================================================================


# -----------------------------------------------------------------------------
# Profile Level
# 1 = Baseline (L1) -- essential controls for all organizations
# 2 = Hardened (L2) -- adds IP access lists, network isolation, data masking
# 3 = Maximum Security (L3) -- strictest controls for regulated industries
# -----------------------------------------------------------------------------
profile_level = 1


# -----------------------------------------------------------------------------
# Databricks Provider Configuration
# -----------------------------------------------------------------------------

# Your Databricks workspace URL
# Azure:  https://adb-1234567890123456.7.azuredatabricks.net
# AWS:    https://dbc-a1b2c3d4-e5f6.cloud.databricks.com
# GCP:    https://1234567890123456.7.gcp.databricks.com
databricks_workspace_url = "https://adb-1234567890.12.azuredatabricks.net"

# Databricks personal access token or service principal token
# WARNING: This is a sensitive value. Use environment variables in production:
#   export TF_VAR_databricks_token="dapi..."
databricks_token = ""


# -----------------------------------------------------------------------------
# Section 1.1: SSO Enforcement
# Set to true to disable local password login and enforce SSO
# -----------------------------------------------------------------------------
enable_sso_enforcement = true


# -----------------------------------------------------------------------------
# Section 1.2: Service Principal Security
# Purpose-specific service principals for automation
# -----------------------------------------------------------------------------
service_principals = {
  "svc-etl-pipeline" = { display_name = "SVC - ETL Pipeline" }
  "svc-ml-training"  = { display_name = "SVC - ML Training" }
  "svc-reporting"    = { display_name = "SVC - BI Reporting" }
}


# -----------------------------------------------------------------------------
# Section 1.3: IP Access Lists (L2+ only)
# CIDR blocks to allow/deny workspace access
# Only applied when profile_level >= 2
# -----------------------------------------------------------------------------
allowed_ip_cidrs = [
  # "203.0.113.0/24",    # Corporate office egress
  # "198.51.100.0/24",   # VPN egress
]

blocked_ip_cidrs = [
  # "192.0.2.0/24",      # Known-bad range
]


# -----------------------------------------------------------------------------
# Section 3.1: Cluster Policies
# Allowed Databricks Runtime versions and node types
# -----------------------------------------------------------------------------
allowed_spark_versions = ["13.3.x-scala2.12", "14.3.x-scala2.12", "15.4.x-scala2.12"]
allowed_node_types     = ["Standard_DS3_v2", "Standard_DS4_v2", "i3.xlarge", "i3.2xlarge"]

autotermination_minutes_default = 30
autotermination_minutes_max     = 120


# -----------------------------------------------------------------------------
# Section 3.2: Network Isolation (L2+ only)
# Disable public IPs on cluster nodes
# -----------------------------------------------------------------------------
enable_no_public_ip = true


# -----------------------------------------------------------------------------
# Section 4.1: Secret Scopes
# Databricks-backed secret scopes for credential storage
# -----------------------------------------------------------------------------
secret_scopes = {
  "production-secrets" = { initial_manage_principal = "admins" }
}


# -----------------------------------------------------------------------------
# Section 4.2: External Secret Store (L2+, Azure only)
# Azure Key Vault-backed secret scope
# Leave empty to skip external secret store creation
# -----------------------------------------------------------------------------
azure_keyvault_resource_id = ""
azure_keyvault_dns_name    = ""


# -----------------------------------------------------------------------------
# Section 5.1: Security Monitoring
# Enable verbose audit logging
# -----------------------------------------------------------------------------
enable_verbose_audit_logs = true
