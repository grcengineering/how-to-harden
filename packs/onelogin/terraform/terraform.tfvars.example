# =============================================================================
# OneLogin Hardening Code Pack - Example Variable Values
# How to Harden (howtoharden.com)
#
# Copy this file to terraform.tfvars and fill in your values.
# NEVER commit terraform.tfvars to version control -- it contains secrets.
#
# Usage:
#   cp terraform.tfvars.example terraform.tfvars
#   # Edit terraform.tfvars with your values
#   terraform plan
#   terraform apply
# =============================================================================


# -----------------------------------------------------------------------------
# Profile Level
# 1 = Baseline (L1) -- essential controls for all organizations
# 2 = Hardened (L2) -- adds SmartFactor, device trust, IP allowlisting
# 3 = Maximum Security (L3) -- strictest controls for regulated industries
# -----------------------------------------------------------------------------
profile_level = 1


# -----------------------------------------------------------------------------
# OneLogin Provider Configuration
# -----------------------------------------------------------------------------

# API client ID -- generate at Developers > API Credentials
onelogin_client_id = ""

# API client secret
# WARNING: This is a sensitive value. Use environment variables in production:
#   export TF_VAR_onelogin_client_secret="your-secret"
onelogin_client_secret = ""


# -----------------------------------------------------------------------------
# Section 1.1: Password Policy
# Minimum password length (12 for L1, 14+ for L2/L3)
# -----------------------------------------------------------------------------
password_min_length              = 12
password_max_failed_attempts     = 5
password_lockout_duration_minutes = 30
password_history_count           = 10
password_expiry_days             = 90


# -----------------------------------------------------------------------------
# Section 1.2: Session Controls
# Session and idle timeout values in minutes
# -----------------------------------------------------------------------------
session_timeout_minutes = 480
idle_timeout_minutes    = 15


# -----------------------------------------------------------------------------
# Section 2.1: MFA Enforcement
# Policy name for MFA requirement
# -----------------------------------------------------------------------------
mfa_policy_name = "HTH MFA Required Policy"


# -----------------------------------------------------------------------------
# Section 2.2: SmartFactor Authentication (L2+ only)
# Requires OneLogin Expert plan
# -----------------------------------------------------------------------------
smartfactor_policy_name = "HTH SmartFactor Policy"


# -----------------------------------------------------------------------------
# Section 2.3: Phishing-Resistant MFA for Admins (L2+ only)
# OneLogin user IDs for administrators requiring WebAuthn-only authentication.
# Find at: Users > select user > copy user ID from URL
# -----------------------------------------------------------------------------
admin_user_ids = [
  # 12345678,   # admin1@company.com
  # 87654321,   # admin2@company.com
]
admin_mfa_policy_name = "HTH Admin WebAuthn Policy"


# -----------------------------------------------------------------------------
# Section 3.1: Delegated Administration
# Whether to create custom least-privilege roles
# -----------------------------------------------------------------------------
create_custom_roles = true


# -----------------------------------------------------------------------------
# Section 3.2: IP Address Allowlisting (L2+ only)
# Comma-separated IP addresses or CIDRs allowed to access OneLogin
# Leave empty to skip IP restriction
# -----------------------------------------------------------------------------
allowed_ip_addresses = ""
# allowed_ip_addresses = "203.0.113.0/24,198.51.100.0/24"


# -----------------------------------------------------------------------------
# Section 5.1: Audit Logging / SIEM Integration
# Webhook URL for event log export (leave empty to skip)
# -----------------------------------------------------------------------------
siem_webhook_url = ""
# siem_webhook_url = "https://your-siem.example.com/api/webhook/onelogin"
