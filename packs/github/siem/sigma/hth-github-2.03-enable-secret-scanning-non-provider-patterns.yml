title: GitHub Secret Scanning Custom Pattern Deleted or Scanning Disabled
id: c9d0e1f2-a3b4-4c5d-6e7f-809102132435
status: test
description: |
    Detects when a custom secret scanning pattern is deleted or secret scanning is
    disabled on a repository. Custom patterns extend secret scanning to detect
    organization-specific secrets that default patterns would miss.
    This corresponds to HTH GitHub control hth-github-2.03-enable-secret-scanning-non-provider-patterns (section 2.3, L2).
references:
    - https://howtoharden.com/guides/github/
    - https://docs.github.com/en/organizations/keeping-your-organization-secure
author: How to Harden
date: 2026/02/14
tags:
    - attack.defense_evasion
    - attack.t1562
logsource:
    product: github
    service: audit
# HTH Guide Excerpt: begin detection
detection:
    selection_pattern_delete:
        action: 'repository_secret_scanning_custom_pattern.delete'
    selection_scanning_disable:
        action: 'repository_secret_scanning.disable'
    condition: selection_pattern_delete or selection_scanning_disable
fields:
    - actor
    - action
    - org
    - repo
    - created_at
# HTH Guide Excerpt: end detection
falsepositives:
    - Custom pattern refinement
level: medium
