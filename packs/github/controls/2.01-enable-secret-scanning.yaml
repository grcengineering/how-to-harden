id: "github-2.1"
vendor: "github"
title: "Enable Secret Scanning on All Repositories"
section: "2.1"
profile_level: 1
severity: "critical"
guide_url: "https://howtoharden.com/guides/github/#21-enable-secret-scanning"
description: >
  Enable GitHub secret scanning on all repositories to automatically detect committed
  secrets such as API keys, tokens, and credentials. Secrets committed to source code
  are a primary vector for supply chain attacks â€” adversaries who gain read access to
  a repository immediately gain all embedded credentials.
compliance:
  soc2: ["CC6.1", "CC7.1"]
  nist_800_53: ["IA-5(7)", "SC-28"]
  iso_27001: ["A.10.1.2"]
  pci_dss: ["6.5.3"]
audit:
  - id: "secret-scanning-enabled"
    description: "Verify secret scanning is enabled on repositories (check how-to-harden repo as representative)"
    api:
      method: GET
      endpoint: "/repos/{org}/how-to-harden"
      check: '.security_and_analysis.secret_scanning.status == "enabled"'
    expected: true
  - id: "secret-scanning-push-protection"
    description: "Verify secret scanning push protection is enabled to block secrets before they are committed"
    api:
      method: GET
      endpoint: "/repos/{org}/how-to-harden"
      check: '.security_and_analysis.secret_scanning_push_protection.status == "enabled"'
    expected: true
  - id: "no-open-secret-alerts"
    description: "Verify no open secret scanning alerts exist across the organization"
    api:
      method: GET
      endpoint: "/orgs/{org}/secret-scanning/alerts?state=open"
      check: '. | length == 0'
    expected: true
tags: ["secrets", "scanning", "push-protection", "credentials", "supply-chain"]
