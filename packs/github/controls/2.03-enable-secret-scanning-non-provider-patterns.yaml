id: "github-2.3"
vendor: "github"
title: "Enable Secret Scanning for Non-Provider Patterns"
section: "2.3"
profile_level: 3
severity: "medium"
guide_url: "https://howtoharden.com/guides/github/#23-secret-scanning-non-provider-patterns"
description: >
  Enable secret scanning for non-provider patterns to detect generic secrets like
  private keys, database connection strings, and custom tokens that don't match a
  known provider pattern. By default, GitHub only scans for known provider patterns
  (AWS keys, GitHub tokens, etc.). Enabling non-provider patterns catches a broader
  set of leaked credentials at the cost of higher false positives.
compliance:
  soc2: ["CC6.1"]
  nist_800_53: ["IA-5", "SC-28"]
  iso_27001: ["A.9.2.4"]
audit:
  - id: "secret-scanning-non-provider-enabled"
    description: "Verify secret scanning non-provider patterns is enabled on the repository"
    api:
      method: GET
      endpoint: "/repos/{org}/how-to-harden"
      check: '.security_and_analysis.secret_scanning_non_provider_patterns.status == "enabled"'
    expected: true
tags: ["secret-scanning", "credentials", "non-provider", "advanced-detection"]
