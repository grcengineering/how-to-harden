# AUTO-GENERATED by scripts/sync-packs-to-data.sh â€” do not edit manually
# Generated: 2026-02-19T16:51:52Z

"4.1":
  db:
    lang: "sql"
    filename: "hth-sailpoint-4.01-detect-anomalies.sql"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/sailpoint/db/hth-sailpoint-4.01-detect-anomalies.sql"
    excerpts:
      db-detect-anomalies:
        content: |
            -- Detect unusual account creation
            SELECT created_by, COUNT(*) as account_count
            FROM provisioning_events
            WHERE action = 'CREATE'
            AND timestamp > NOW() - INTERVAL '1 hour'
            GROUP BY created_by
            HAVING COUNT(*) > 10;
          
            -- Detect certification modifications
            SELECT admin_user, certification_name, action
            FROM governance_events
            WHERE action IN ('APPROVE_ALL', 'CERTIFICATION_MODIFY')
            AND timestamp > NOW() - INTERVAL '24 hours';

