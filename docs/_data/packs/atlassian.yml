# AUTO-GENERATED by scripts/sync-packs-to-data.sh â€” do not edit manually
# Generated: 2026-02-19T20:09:16Z

"2.2":
  api:
    lang: "bash"
    filename: "hth-atlassian-2.02-audit-app-events.sh"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/atlassian/api/hth-atlassian-2.02-audit-app-events.sh"
    excerpts:
      api-audit-app-events:
        content: |
            # Get app audit events
            curl -X GET "https://api.atlassian.com/admin/v1/orgs/${ORG_ID}/audit-events?filter=app" \
            -H "Authorization: Bearer ${API_TOKEN}"

"3.2":
  sdk:
    lang: "python"
    filename: "hth-atlassian-3.02-webhook-validation.py"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/atlassian/sdk/hth-atlassian-3.02-webhook-validation.py"
    excerpts:
      sdk-webhook-validation:
        content: |
            import hmac
            import hashlib
          
            def validate_webhook(request, secret):
              signature = request.headers.get('X-Hub-Signature')
              payload = request.body
          
              expected = 'sha256=' + hmac.new(
                  secret.encode(),
                  payload,
                  hashlib.sha256
              ).hexdigest()
          
              return hmac.compare_digest(signature, expected)

