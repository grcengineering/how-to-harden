# AUTO-GENERATED by scripts/sync-packs-to-data.sh â€” do not edit manually
# Generated: 2026-02-19T16:51:03Z

"1.1":
  api:
    lang: "bash"
    filename: "hth-atlassian-1.01-manage-auth-policies.sh"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/atlassian/api/hth-atlassian-1.01-manage-auth-policies.sh"
    excerpts:
      api-manage-auth-policies:
        content: |
            # Get authentication policies
            curl -X GET "https://api.atlassian.com/admin/v1/orgs/${ORG_ID}/policies/authentication" \
            -H "Authorization: Bearer ${API_TOKEN}" \
            -H "Accept: application/json"
          
            # Update authentication policy to enforce SSO
            curl -X PUT "https://api.atlassian.com/admin/v1/orgs/${ORG_ID}/policies/authentication/${POLICY_ID}" \
            -H "Authorization: Bearer ${API_TOKEN}" \
            -H "Content-Type: application/json" \
            -d '{
              "type": "authentication-policy",
              "attributes": {
                "ssoEnforced": true,
                "passwordAuthEnabled": false
              }
            }'

"2.2":
  api:
    lang: "bash"
    filename: "hth-atlassian-2.02-audit-app-events.sh"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/atlassian/api/hth-atlassian-2.02-audit-app-events.sh"
    excerpts:
      api-audit-app-events:
        content: |
            # Get app audit events
            curl -X GET "https://api.atlassian.com/admin/v1/orgs/${ORG_ID}/audit-events?filter=app" \
            -H "Authorization: Bearer ${API_TOKEN}"

"3.2":
  sdk:
    lang: "python"
    filename: "hth-atlassian-3.02-webhook-validation.py"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/atlassian/sdk/hth-atlassian-3.02-webhook-validation.py"
    excerpts:
      sdk-webhook-validation:
        content: |
            import hmac
            import hashlib
          
            def validate_webhook(request, secret):
              signature = request.headers.get('X-Hub-Signature')
              payload = request.body
          
              expected = 'sha256=' + hmac.new(
                  secret.encode(),
                  payload,
                  hashlib.sha256
              ).hexdigest()
          
              return hmac.compare_digest(signature, expected)

"5.1":
  db:
    lang: "sql"
    filename: "hth-atlassian-5.01-detect-anomalies.sql"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/atlassian/db/hth-atlassian-5.01-detect-anomalies.sql"
    excerpts:
      db-detect-anomalies:
        content: |
            -- Detect bulk data access
            SELECT user_id, action, COUNT(*) as action_count
            FROM atlassian_audit_log
            WHERE action IN ('content.view', 'issue.view')
            AND timestamp > NOW() - INTERVAL '1 hour'
            GROUP BY user_id, action
            HAVING COUNT(*) > 100;
          
            -- Detect permission changes
            SELECT *
            FROM atlassian_audit_log
            WHERE action LIKE '%permission%'
            AND timestamp > NOW() - INTERVAL '24 hours';
          
            -- Detect app installations
            SELECT *
            FROM atlassian_audit_log
            WHERE action = 'app.installed'
            AND timestamp > NOW() - INTERVAL '7 days';

