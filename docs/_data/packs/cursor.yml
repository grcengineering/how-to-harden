# AUTO-GENERATED by scripts/sync-packs-to-data.sh — do not edit manually
# Generated: 2026-02-19T16:51:13Z

"2.1":
  cli:
    lang: "bash"
    filename: "hth-cursor-2.01-configure-privacy-mode.sh"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/cursor/cli/hth-cursor-2.01-configure-privacy-mode.sh"
    excerpts:
      cli-global-privacy-config:
        content: |
            # Global settings — disables cloud AI providers and enables privacy mode
            CURSOR_SETTINGS_DIR="${HOME}/Library/Application Support/Cursor/User"
            SETTINGS_FILE="${CURSOR_SETTINGS_DIR}/settings.json"
          
            # Merge privacy settings into existing config (requires jq)
            jq '. + {
            "cursor.privacyMode": true,
            "cursor.telemetry": false,
            "cursor.aiProviders.allowOpenAI": false,
            "cursor.aiProviders.allowAnthropic": false
            }' "${SETTINGS_FILE}" > "${SETTINGS_FILE}.tmp" \
            && mv "${SETTINGS_FILE}.tmp" "${SETTINGS_FILE}"
          
            echo "Global privacy mode enabled for Cursor"
      cli-workspace-json-snippet:
        content: |
            # Add to .vscode/settings.json and commit to repository:
            # {
            #   "cursor.privacyMode": true
            # }
      cli-workspace-privacy-config:
        content: |
            # Workspace settings — commit to repo to enforce per-project privacy
            mkdir -p .vscode
            cat > .vscode/settings.json << 'EOF'
            {
            "cursor.privacyMode": true,
            "cursor.chat.enabled": false,
            "cursor.autocomplete.enabled": false
            }
            EOF
          
            echo "Workspace privacy settings written to .vscode/settings.json"
      cli-enforce-privacy-policy:
        content: |
            # Enforce Privacy Mode for all Cursor workspaces
            CURSOR_SETTINGS_DIR="${HOME}/Library/Application Support/Cursor/User"
            SETTINGS_FILE="${CURSOR_SETTINGS_DIR}/settings.json"
          
            # Enable global privacy mode
            jq '.["cursor.privacyMode"] = true' "${SETTINGS_FILE}" > tmp.json \
            && mv tmp.json "${SETTINGS_FILE}"
          
            echo "Privacy Mode enabled globally for Cursor"

"2.2":
  cli:
    lang: "bash"
    filename: "hth-cursor-2.02-configure-ai-provider-restrictions.sh"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/cursor/cli/hth-cursor-2.02-configure-ai-provider-restrictions.sh"
    excerpts:
      cli-restrict-ai-providers:
        content: |
            # Restrict to approved AI providers — disable unapproved vendors
            CURSOR_SETTINGS_DIR="${HOME}/Library/Application Support/Cursor/User"
            SETTINGS_FILE="${CURSOR_SETTINGS_DIR}/settings.json"
          
            jq '. + {
            "cursor.aiProviders.openai.enabled": true,
            "cursor.aiProviders.anthropic.enabled": false,
            "cursor.aiProviders.allowCustom": false
            }' "${SETTINGS_FILE}" > "${SETTINGS_FILE}.tmp" \
            && mv "${SETTINGS_FILE}.tmp" "${SETTINGS_FILE}"
          
            echo "AI provider restrictions applied"

"2.3":
  cli:
    lang: "bash"
    filename: "hth-cursor-2.03-enable-local-ai-models.sh"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/cursor/cli/hth-cursor-2.03-enable-local-ai-models.sh"
    excerpts:
      cli-install-local-model:
        content: |
            # Install Ollama local LLM runtime
            brew install ollama  # macOS
            # or download from https://ollama.ai
          
            # Pull code model
            ollama pull codellama:13b
          
            # Start Ollama server (runs on localhost:11434)
            ollama serve
      cli-configure-local-model:
        content: |
            # Point Cursor at local Ollama and disable all cloud providers
            CURSOR_SETTINGS_DIR="${HOME}/Library/Application Support/Cursor/User"
            SETTINGS_FILE="${CURSOR_SETTINGS_DIR}/settings.json"
          
            jq '. + {
            "cursor.aiProviders.custom": [
              {
                "name": "Local Ollama",
                "endpoint": "http://localhost:11434/v1",
                "model": "codellama",
                "type": "openai-compatible"
              }
            ],
            "cursor.aiProviders.openai.enabled": false,
            "cursor.aiProviders.anthropic.enabled": false
            }' "${SETTINGS_FILE}" > "${SETTINGS_FILE}.tmp" \
            && mv "${SETTINGS_FILE}.tmp" "${SETTINGS_FILE}"
          
            echo "Cursor configured to use local Ollama model only"

"3.1":
  cli:
    lang: "bash"
    filename: "hth-cursor-3.01-manage-api-keys.sh"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/cursor/cli/hth-cursor-3.01-manage-api-keys.sh"
    excerpts:
      cli-bad-hardcoded-key:
        content: |
            # BAD - Don't do this: hardcoded API key in settings.json
            # {
            #   "cursor.openai.apiKey": "sk-proj-abc123..."
            # }
      cli-env-var-api-keys:
        content: |
            # Store AI provider API keys in environment variables
            # Add these to ~/.zshrc or ~/.bashrc
            export OPENAI_API_KEY="sk-proj-..."
            export ANTHROPIC_API_KEY="sk-ant-..."
          
            # Verify keys are set
            echo $OPENAI_API_KEY  # Should print key
      cli-reload-shell:
        content: |
            # Reload shell to pick up new environment variables
            source ~/.zshrc
      cli-secret-manager-api-keys:
        content: |
            # Use organization secret manager
            # AWS Secrets Manager
            aws secretsmanager get-secret-value --secret-id cursor/openai-api-key --query SecretString --output text
          
            # HashiCorp Vault
            vault kv get -field=api_key secret/cursor/openai
      cli-keychain-api-keys:
        content: |
            # Store in Keychain
            security add-generic-password -a "$USER" -s "cursor-openai-key" -w "sk-proj-..."
          
            # Retrieve in shell
            security find-generic-password -a "$USER" -s "cursor-openai-key" -w
      cli-verify-no-hardcoded-keys:
        content: |
            # Search for hardcoded API keys in Cursor settings
            grep -r "apiKey" ~/Library/Application\ Support/Cursor/User/

"3.2":
  cli:
    lang: "bash"
    filename: "hth-cursor-3.02-rotate-api-keys.sh"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/cursor/cli/hth-cursor-3.02-rotate-api-keys.sh"
    excerpts:
      cli-rotate-api-keys:
        content: |
            # Rotate OpenAI API key
            echo "Rotating OpenAI API key..."
            # Generate new key via API (if supported)
            # Update environment
            # Revoke old key
          
            echo "API keys rotated successfully"
      cli-update-env-after-rotation:
        content: |
            # Update environment variable with new key
            export OPENAI_API_KEY="sk-proj-NEW-KEY"

"3.3":
  db:
    lang: "sql"
    filename: "hth-cursor-3.03-monitor-api-usage.sql"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/cursor/db/hth-cursor-3.03-monitor-api-usage.sql"
    excerpts:
      db-detect-usage-spike:
        content: |
            -- Detect unusual API usage spike (3x above average)
            -- Requires logging API calls to a cursor_api_logs table
            SELECT date, count(*) as api_calls, sum(tokens) as total_tokens
            FROM cursor_api_logs
            GROUP BY date
            HAVING count(*) > (SELECT avg(count) * 3 FROM cursor_api_logs);

"4.1":
  cli:
    lang: "bash"
    filename: "hth-cursor-4.01-configure-workspace-trust.sh"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/cursor/cli/hth-cursor-4.01-configure-workspace-trust.sh"
    excerpts:
      cli-enable-workspace-trust:
        content: |
            # Enable Workspace Trust — prevent automatic code execution in untrusted repos
            CURSOR_SETTINGS_DIR="${HOME}/Library/Application Support/Cursor/User"
            SETTINGS_FILE="${CURSOR_SETTINGS_DIR}/settings.json"
          
            jq '. + {
            "security.workspace.trust.enabled": true,
            "security.workspace.trust.startupPrompt": "always",
            "security.workspace.trust.emptyWindow": false,
            "security.workspace.trust.untrustedFiles": "restricted"
            }' "${SETTINGS_FILE}" > "${SETTINGS_FILE}.tmp" \
            && mv "${SETTINGS_FILE}.tmp" "${SETTINGS_FILE}"
          
            echo "Workspace Trust enabled"
      cli-configure-trusted-folders:
        content: |
            # Add trusted parent directories for company and personal code
            CURSOR_SETTINGS_DIR="${HOME}/Library/Application Support/Cursor/User"
            SETTINGS_FILE="${CURSOR_SETTINGS_DIR}/settings.json"
          
            jq '. + {
            "security.workspace.trust.trustedFolders": [
              "~/work/company-name",
              "~/projects/personal"
            ]
            }' "${SETTINGS_FILE}" > "${SETTINGS_FILE}.tmp" \
            && mv "${SETTINGS_FILE}.tmp" "${SETTINGS_FILE}"
          
            echo "Trusted folders configured"

"4.2":
  cli:
    lang: "bash"
    filename: "hth-cursor-4.02-configure-secret-scanning.sh"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/cursor/cli/hth-cursor-4.02-configure-secret-scanning.sh"
    excerpts:
      cli-install-secret-scanning:
        content: |
            # Install pre-commit
            pip install pre-commit
          
            # Create .pre-commit-config.yaml
            cat > .pre-commit-config.yaml <<EOF
            repos:
            - repo: https://github.com/trufflesecurity/trufflehog
              rev: v3.63.0
              hooks:
                - id: trufflehog
                  args: ['--max-depth=1']
            EOF
          
            # Install hook
            pre-commit install
  sdk:
    lang: "python"
    filename: "hth-cursor-4.02-test-secret-scanning.py"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/cursor/sdk/hth-cursor-4.02-test-secret-scanning.py"
    excerpts:
      sdk-test-secret-file:
        content: |
            # test.py - Create test file with fake secret to verify scanning
            API_KEY = "sk-proj-1234567890abcdef"

"5.1":
  cli:
    lang: "bash"
    filename: "hth-cursor-5.01-configure-extension-allowlist.sh"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/cursor/cli/hth-cursor-5.01-configure-extension-allowlist.sh"
    excerpts:
      cli-extension-allowlist:
        content: |
            # Restrict extensions to approved list and disable auto-update
            CURSOR_SETTINGS_DIR="${HOME}/Library/Application Support/Cursor/User"
            SETTINGS_FILE="${CURSOR_SETTINGS_DIR}/settings.json"
          
            jq '. + {
            "extensions.allowedExtensions": [
              "github.copilot",
              "ms-python.python",
              "esbenp.prettier-vscode"
            ],
            "extensions.autoUpdate": false
            }' "${SETTINGS_FILE}" > "${SETTINGS_FILE}.tmp" \
            && mv "${SETTINGS_FILE}.tmp" "${SETTINGS_FILE}"
          
            echo "Extension allowlist configured"

"6.1":
  cli:
    lang: "bash"
    filename: "hth-cursor-6.01-disable-telemetry.sh"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/cursor/cli/hth-cursor-6.01-disable-telemetry.sh"
    excerpts:
      cli-disable-telemetry:
        content: |
            # Disable all telemetry — prevents code snippets and metadata from being sent
            CURSOR_SETTINGS_DIR="${HOME}/Library/Application Support/Cursor/User"
            SETTINGS_FILE="${CURSOR_SETTINGS_DIR}/settings.json"
          
            jq '. + {
            "telemetry.telemetryLevel": "off",
            "cursor.telemetry.enabled": false,
            "redhat.telemetry.enabled": false
            }' "${SETTINGS_FILE}" > "${SETTINGS_FILE}.tmp" \
            && mv "${SETTINGS_FILE}.tmp" "${SETTINGS_FILE}"
          
            echo "Telemetry and crash reporting disabled"

"7.1":
  cli:
    lang: "bash"
    filename: "hth-cursor-7.01-enable-usage-logging.sh"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/cursor/cli/hth-cursor-7.01-enable-usage-logging.sh"
    excerpts:
      cli-enable-logging:
        content: |
            # Enable built-in logging for audit and compliance
            CURSOR_SETTINGS_DIR="${HOME}/Library/Application Support/Cursor/User"
            SETTINGS_FILE="${CURSOR_SETTINGS_DIR}/settings.json"
          
            jq '. + {
            "cursor.logging.enabled": true,
            "cursor.logging.level": "info",
            "cursor.logging.outputChannel": true
            }' "${SETTINGS_FILE}" > "${SETTINGS_FILE}.tmp" \
            && mv "${SETTINGS_FILE}.tmp" "${SETTINGS_FILE}"
          
            echo "Cursor usage logging enabled"
      cli-export-logs-to-siem:
        content: |
            # Parse Cursor logs and send to SIEM
            tail -f ~/Library/Logs/Cursor/main.log | grep "ai.request" | \
            while read line; do
              curl -X POST https://siem.company.com/cursor-logs \
                -H "Content-Type: application/json" \
                -d "$line"
            done
  db:
    lang: "sql"
    filename: "hth-cursor-7.01-monitoring-queries.sql"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/cursor/db/hth-cursor-7.01-monitoring-queries.sql"
    excerpts:
      db-detect-excessive-usage:
        content: |
            -- Detect excessive AI usage (flag heavy users with >1000 requests/day)
            SELECT user, count(*) as ai_requests, date
            FROM cursor_logs
            WHERE event_type = 'ai.completion'
            GROUP BY user, date
            HAVING count(*) > 1000;
      db-detect-privacy-bypass:
        content: |
            -- Detect privacy mode bypass (cloud AI requests in confidential workspaces)
            SELECT user, workspace, timestamp
            FROM cursor_logs
            WHERE event_type = 'ai.request'
            AND privacy_mode = false
            AND workspace LIKE '%confidential%';

"8.1":
  cli:
    lang: "bash"
    filename: "hth-cursor-8.01-deploy-managed-settings.sh"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/cursor/cli/hth-cursor-8.01-deploy-managed-settings.sh"
    excerpts:
      cli-deploy-managed-settings:
        content: |
            # Organization-wide managed settings for Cursor Business
            # Deploy via MDM (Jamf, Intune, etc.) to all developer machines
            CURSOR_SETTINGS_DIR="${HOME}/Library/Application Support/Cursor/User"
            SETTINGS_FILE="${CURSOR_SETTINGS_DIR}/settings.json"
          
            jq '. + {
            "cursor.privacyMode": true,
            "cursor.aiProviders.openai.enabled": true,
            "cursor.aiProviders.anthropic.enabled": false,
            "cursor.telemetry.enabled": false,
            "security.workspace.trust.enabled": true
            }' "${SETTINGS_FILE}" > "${SETTINGS_FILE}.tmp" \
            && mv "${SETTINGS_FILE}.tmp" "${SETTINGS_FILE}"
          
            echo "Organization-wide managed settings deployed"

