# AUTO-GENERATED by scripts/sync-packs-to-data.sh — do not edit manually
# Generated: 2026-02-19T16:51:41Z

"1.2":
  cli:
    lang: "text"
    filename: "hth-netsuite-1.02-role-structure.txt"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/netsuite/cli/hth-netsuite-1.02-role-structure.txt"
    excerpts:
      cli-role-structure:
        content: |
            Roles:
            ├── Administrator (limit to 2-3 users)
            ├── Financial Controller
            │   └── Full financial access, reporting
            ├── Accounts Payable
            │   └── Vendor bills, payments (no GL access)
            ├── Accounts Receivable
            │   └── Customer invoices, receipts
            ├── Sales Representative
            │   └── Quotes, orders (no financial reports)
            └── Integration Role
              └── API access for specific integrations

"2.2":
  sdk:
    lang: "javascript"
    filename: "hth-netsuite-2.02-oauth-configuration.js"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/netsuite/sdk/hth-netsuite-2.02-oauth-configuration.js"
    excerpts:
      sdk-oauth-configuration:
        content: |
            // SuiteScript OAuth configuration
            var oauth = require('N/oauth');
          
            var tokenResponse = oauth.getToken({
              grantType: oauth.GrantType.AUTHORIZATION_CODE,
              code: authorizationCode,
              redirectUri: 'https://app.example.com/callback'
            });

"3.2":
  sdk:
    lang: "javascript"
    filename: "hth-netsuite-3.02-secure-restlet.js"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/netsuite/sdk/hth-netsuite-3.02-secure-restlet.js"
    excerpts:
      sdk-secure-restlet:
        content: |
            // Secure RESTlet example
            // @NApiVersion 2.x
            // @NScriptType Restlet
            // @NModuleScope SameAccount
            define(['N/record', 'N/runtime'], function(record, runtime) {
          
              function doGet(requestParams) {
                  // Validate user permissions
                  var user = runtime.getCurrentUser();
                  if (user.role !== AUTHORIZED_ROLE_ID) {
                      throw new Error('Unauthorized');
                  }
          
                  // Validate input parameters
                  if (!requestParams.id || isNaN(requestParams.id)) {
                      throw new Error('Invalid parameters');
                  }
          
                  // Rate limit check (implement externally)
          
                  // Return data with minimal fields
                  return {
                      id: requestParams.id,
                      // Only return necessary fields
                  };
              }
          
              return {
                  get: doGet
              };
            });

"5.1":
  db:
    lang: "sql"
    filename: "hth-netsuite-5.01-detection-queries.sql"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/netsuite/db/hth-netsuite-5.01-detection-queries.sql"
    excerpts:
      db-detect-unusual-activity:
        content: |
            -- Detect unusual transaction volumes
            SELECT entity, COUNT(*) as txn_count
            FROM Transaction
            WHERE trandate >= TODAY - 7
            GROUP BY entity
            HAVING COUNT(*) > 100;
          
            -- Detect login anomalies
            SELECT user, ipaddress, COUNT(*) as login_count
            FROM LoginAudit
            WHERE date >= TODAY - 1
            GROUP BY user, ipaddress
            HAVING COUNT(*) > 20;
          
            -- Detect bulk data exports
            SELECT user, action, recordtype, COUNT(*) as record_count
            FROM SystemNote
            WHERE date >= TODAY - 1
            AND action = 'export'
            GROUP BY user, action, recordtype
            HAVING COUNT(*) > 1000;

