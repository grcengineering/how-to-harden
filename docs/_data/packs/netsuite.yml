# AUTO-GENERATED by scripts/sync-packs-to-data.sh â€” do not edit manually
# Generated: 2026-02-20T08:35:01Z

"3.2":
  sdk:
    lang: "javascript"
    filename: "hth-netsuite-3.02-secure-restlet.js"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/netsuite/sdk/hth-netsuite-3.02-secure-restlet.js"
    excerpts:
      sdk-secure-restlet:
        content: |
            // Secure RESTlet example
            // @NApiVersion 2.x
            // @NScriptType Restlet
            // @NModuleScope SameAccount
            define(['N/record', 'N/runtime'], function(record, runtime) {
          
              function doGet(requestParams) {
                  // Validate user permissions
                  var user = runtime.getCurrentUser();
                  if (user.role !== AUTHORIZED_ROLE_ID) {
                      throw new Error('Unauthorized');
                  }
          
                  // Validate input parameters
                  if (!requestParams.id || isNaN(requestParams.id)) {
                      throw new Error('Invalid parameters');
                  }
          
                  // Rate limit check (implement externally)
          
                  // Return data with minimal fields
                  return {
                      id: requestParams.id,
                      // Only return necessary fields
                  };
              }
          
              return {
                  get: doGet
              };
            });

