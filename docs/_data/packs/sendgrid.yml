# AUTO-GENERATED by scripts/sync-packs-to-data.sh â€” do not edit manually
# Generated: 2026-02-19T00:06:48Z

"1.1":
  terraform:
    lang: "hcl"
    filename: "hth-sendgrid-1.01-enable-two-factor-authentication.tf"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/sendgrid/terraform/hth-sendgrid-1.01-enable-two-factor-authentication.tf"
    excerpts:
      terraform:
        content: |
            # Two-factor authentication is enforced at the account level by SendGrid.
            # It cannot be managed via Terraform. Verify 2FA is active for all users
            # through the SendGrid UI: Settings > Two-Factor Authentication.

"1.2":
  terraform:
    lang: "hcl"
    filename: "hth-sendgrid-1.02-configure-saml-single-sign-on.tf"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/sendgrid/terraform/hth-sendgrid-1.02-configure-saml-single-sign-on.tf"
    excerpts:
      terraform:
        content: |
            resource "sendgrid_sso_integration" "corporate" {
            count = var.profile_level >= 2 && var.sso_signin_url != "" ? 1 : 0
          
            name        = var.sso_name
            enabled     = true
            signin_url  = var.sso_signin_url
            signout_url = var.sso_signout_url
            entity_id   = var.sso_entity_id
            }
          
            resource "sendgrid_sso_certificate" "corporate" {
            count = var.profile_level >= 2 && var.sso_certificate != "" ? 1 : 0
          
            integration_id     = sendgrid_sso_integration.corporate[0].id
            public_certificate = var.sso_certificate
            }

"1.3":
  terraform:
    lang: "hcl"
    filename: "hth-sendgrid-1.03-configure-sso-teammates.tf"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/sendgrid/terraform/hth-sendgrid-1.03-configure-sso-teammates.tf"
    excerpts:
      terraform:
        content: |
            resource "sendgrid_sso_teammate" "managed" {
            for_each = var.profile_level >= 2 ? {
              for t in var.sso_teammates : t.email => t
            } : {}
          
            email      = each.value.email
            first_name = each.value.first_name
            last_name  = each.value.last_name
            is_admin   = each.value.is_admin
            scopes     = each.value.scopes
            }

"1.4":
  terraform:
    lang: "hcl"
    filename: "hth-sendgrid-1.04-configure-ip-access-management.tf"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/sendgrid/terraform/hth-sendgrid-1.04-configure-ip-access-management.tf"
    excerpts:
      terraform:
        content: |
            # IP Access Management is not yet supported by the kenzo0107/sendgrid provider.
            # Configure via UI: Settings > IP Access Management
            #
            # Recommended automation approach using the SendGrid v3 API:
            #
            # variable "allowed_ips" is defined in variables.tf for future provider support.
            #
            # Manual API enforcement:
            #   for ip in var.allowed_ips; do
            #     curl -X POST https://api.sendgrid.com/v3/access_settings/whitelist \
            #       -H "Authorization: Bearer $SENDGRID_API_KEY" \
            #       -H "Content-Type: application/json" \
            #       -d "{\"ips\": [{\"ip\": \"$ip\"}]}"
            #   done

"2.1":
  terraform:
    lang: "hcl"
    filename: "hth-sendgrid-2.01-use-api-keys-instead-of-passwords.tf"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/sendgrid/terraform/hth-sendgrid-2.01-use-api-keys-instead-of-passwords.tf"
    excerpts:
      terraform:
        content: |
            resource "sendgrid_api_key" "managed" {
            for_each = var.api_keys
          
            name   = each.key
            scopes = each.value.scopes
            }

"2.2":
  terraform:
    lang: "hcl"
    filename: "hth-sendgrid-2.02-implement-api-key-best-practices.tf"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/sendgrid/terraform/hth-sendgrid-2.02-implement-api-key-best-practices.tf"
    excerpts:
      terraform:
        content: |
            # API key best practices are enforced through:
            #   - Named, purpose-specific keys (see hth-sendgrid-2.01)
            #   - Sensitive output values for secret manager integration
            #   - Rotation via Terraform lifecycle: taint and re-apply
            #
            # Recommended .gitignore additions:
            #   terraform.tfvars
            #   *.tfstate
            #   *.tfstate.backup
            #   .terraform/
            #
            # Rotation procedure:
            #   1. terraform taint 'sendgrid_api_key.managed["key_name"]'
            #   2. terraform apply
            #   3. Update secret manager with new key value from output

"2.3":
  terraform:
    lang: "hcl"
    filename: "hth-sendgrid-2.03-implement-least-privilege-api-access.tf"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/sendgrid/terraform/hth-sendgrid-2.03-implement-least-privilege-api-access.tf"
    excerpts:
      terraform:
        content: |
            # Least privilege is enforced by the api_keys variable structure.
            # Each key in var.api_keys requires an explicit set of scopes.
            # Full-access keys are never created by this code pack.
            #
            # Example variable configuration in terraform.tfvars:
            #
            # api_keys = {
            #   transactional_sender = {
            #     scopes = ["mail.send"]
            #   }
            #   marketing_automation = {
            #     scopes = ["mail.send", "marketing.automation.read",
            #               "marketing.automation.update"]
            #   }
            #   stats_reader = {
            #     scopes = ["stats.read", "stats.global.read"]
            #   }
            # }

"2.4":
  terraform:
    lang: "hcl"
    filename: "hth-sendgrid-2.04-configure-api-key-alerts.tf"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/sendgrid/terraform/hth-sendgrid-2.04-configure-api-key-alerts.tf"
    excerpts:
      terraform:
        content: |
            # API key alerting is not natively supported by the Terraform provider.
            # Implement monitoring through:
            #   1. Event webhooks (see hth-sendgrid-4.02) for delivery anomalies
            #   2. External SIEM integration for usage pattern analysis
            #   3. SendGrid UI: Activity > Feed for manual review
            #
            # Compromise response via Terraform:
            #   terraform taint 'sendgrid_api_key.managed["compromised_key"]'
            #   terraform apply

"3.1":
  terraform:
    lang: "hcl"
    filename: "hth-sendgrid-3.01-secure-administrator-access.tf"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/sendgrid/terraform/hth-sendgrid-3.01-secure-administrator-access.tf"
    excerpts:
      terraform:
        content: |
            # Administrator access security is enforced through:
            #   1. SSO teammates (hth-sendgrid-1.03) with explicit is_admin flags
            #   2. Password teammates (hth-sendgrid-3.02) with role-based scopes
            #   3. Terraform state provides a complete access inventory for auditing
            #
            # Operational requirements (outside Terraform):
            #   - Admin accounts limited to 2-3 for redundancy
            #   - 20+ character passwords stored in a vault
            #   - 2FA enabled on all accounts (mandatory since Q4 2020)
            #   - Quarterly access reviews

"3.2":
  terraform:
    lang: "hcl"
    filename: "hth-sendgrid-3.02-configure-teammate-permissions.tf"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/sendgrid/terraform/hth-sendgrid-3.02-configure-teammate-permissions.tf"
    excerpts:
      terraform:
        content: |
            resource "sendgrid_teammate" "managed" {
            for_each = {
              for t in var.teammates : t.email => t
            }
          
            email    = each.value.email
            is_admin = each.value.is_admin
            scopes   = each.value.scopes
            }

"3.3":
  terraform:
    lang: "hcl"
    filename: "hth-sendgrid-3.03-configure-sender-authentication.tf"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/sendgrid/terraform/hth-sendgrid-3.03-configure-sender-authentication.tf"
    excerpts:
      terraform:
        content: |
            resource "sendgrid_sender_authentication" "primary" {
            count = var.authenticated_domain != "" ? 1 : 0
          
            domain    = var.authenticated_domain
            subdomain = var.authenticated_domain_subdomain != "" ? var.authenticated_domain_subdomain : null
            default   = true
            }
          
            resource "sendgrid_link_branding" "primary" {
            count = var.link_branding_domain != "" ? 1 : 0
          
            domain    = var.link_branding_domain
            subdomain = var.link_branding_subdomain != "" ? var.link_branding_subdomain : null
            default   = true
            }

"4.1":
  terraform:
    lang: "hcl"
    filename: "hth-sendgrid-4.01-monitor-email-activity.tf"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/sendgrid/terraform/hth-sendgrid-4.01-monitor-email-activity.tf"
    excerpts:
      terraform:
        content: |
            # Email activity monitoring is an operational practice.
            # Automate through:
            #   1. Event webhooks (see hth-sendgrid-4.02) for SIEM integration
            #   2. SendGrid Stats API for delivery/bounce/spam metrics
            #   3. Activity Feed API for per-message event tracking
            #
            # Key metrics to monitor:
            #   - Delivery rate (target: >95%)
            #   - Bounce rate (alert if >5%)
            #   - Spam complaint rate (alert if >0.1%)
            #   - Unexpected volume spikes (>2x baseline)

"4.2":
  terraform:
    lang: "hcl"
    filename: "hth-sendgrid-4.02-configure-event-webhooks.tf"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/sendgrid/terraform/hth-sendgrid-4.02-configure-event-webhooks.tf"
    excerpts:
      terraform:
        content: |
            resource "sendgrid_event_webhook" "security" {
            count = var.profile_level >= 2 && var.event_webhook_url != "" ? 1 : 0
          
            url           = var.event_webhook_url
            enabled       = true
            signed        = true
            friendly_name = "HTH Security Event Webhook"
          
            # Delivery events
            processed = true
            delivered = true
            dropped   = true
            bounce    = true
            deferred  = true
          
            # Engagement events
            open  = true
            click = true
          
            # Abuse events
            spam_report       = true
            unsubscribe       = true
            group_unsubscribe = true
            group_resubscribe = true
            }

"4.3":
  terraform:
    lang: "hcl"
    filename: "hth-sendgrid-4.03-monitor-for-compromised-accounts.tf"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/sendgrid/terraform/hth-sendgrid-4.03-monitor-for-compromised-accounts.tf"
    excerpts:
      terraform:
        content: |
            # Account compromise detection is an operational practice.
            # Terraform supports the response workflow:
            #
            # Detection (external tooling):
            #   - Event webhooks (hth-sendgrid-4.02) stream to SIEM
            #   - Alert on: volume spikes, bounce spikes, spam complaints
            #   - Regular terraform plan to detect configuration drift
            #
            # Response via Terraform:
            #   1. Rotate API keys:
            #      terraform taint 'sendgrid_api_key.managed["key_name"]'
            #      terraform apply
            #   2. Audit teammates:
            #      terraform plan  # detects unauthorized additions
            #   3. Verify SSO config:
            #      terraform plan  # detects SSO tampering

