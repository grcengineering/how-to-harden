# AUTO-GENERATED by scripts/sync-packs-to-data.sh â€” do not edit manually
# Generated: 2026-02-18T20:49:10Z
# Generated: 2026-02-18T20:49:10Z


"1.1":
"1.1":
  terraform:
  terraform:
    lang: "hcl"
    lang: "hcl"
    filename: "hth-twilio-1.01-configure-saml-sso.tf"
    filename: "hth-twilio-1.01-configure-saml-sso.tf"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/twilio/terraform/hth-twilio-1.01-configure-saml-sso.tf"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/twilio/terraform/hth-twilio-1.01-configure-saml-sso.tf"
    excerpts:
    excerpts:
      terraform:
      terraform:
        content: |
        content: |
            # NOTE: Twilio SSO/SAML configuration is not natively supported by the
            # twilio/twilio Terraform provider as of v0.18.x. SAML SSO must be configured
            # via the Twilio Console (Console > Account > Single Sign-On) or via the
            # Twilio Organizations API (currently in beta).
            #
            # This file provides a null_resource provisioner that uses the Twilio CLI
            # to document the expected SSO state and validate configuration.
          
            resource "null_resource" "sso_saml_validation" {
            count = var.sso_saml_issuer != "" ? 1 : 0
          
            triggers = {
              saml_issuer = var.sso_saml_issuer
              saml_url    = var.sso_saml_url
            }
          
            provisioner "local-exec" {
              command = <<-EOT
                echo "============================================================"
                echo "HTH Twilio 1.1: SAML SSO Configuration"
                echo "============================================================"
                echo ""
                echo "SAML SSO must be configured manually in the Twilio Console:"
                echo "  Console > Account > Single Sign-On"
                echo ""
                echo "Expected configuration:"
                echo "  IdP Issuer:      ${var.sso_saml_issuer}"
                echo "  IdP SSO URL:     ${var.sso_saml_url}"
                echo "  Certificate:     [provided via variable]"
                echo "  SSO Enforcement: ENABLED"
                echo "  Admin Fallback:  ENABLED"
                echo ""
                echo "Validation: Log in via SSO to confirm configuration."
                echo "============================================================"
              EOT
            }
            }
            # NOTE: Twilio SSO/SAML configuration is not natively supported by the
            # twilio/twilio Terraform provider as of v0.18.x. SAML SSO must be configured
            # via the Twilio Console (Console > Account > Single Sign-On) or via the
            # Twilio Organizations API (currently in beta).
            #
            # This file provides a null_resource provisioner that uses the Twilio CLI
            # to document the expected SSO state and validate configuration.
          
            resource "null_resource" "sso_saml_validation" {
            count = var.sso_saml_issuer != "" ? 1 : 0
          
            triggers = {
              saml_issuer = var.sso_saml_issuer
              saml_url    = var.sso_saml_url
            }
          
            provisioner "local-exec" {
              command = <<-EOT
                echo "============================================================"
                echo "HTH Twilio 1.1: SAML SSO Configuration"
                echo "============================================================"
                echo ""
                echo "SAML SSO must be configured manually in the Twilio Console:"
                echo "  Console > Account > Single Sign-On"
                echo ""
                echo "Expected configuration:"
                echo "  IdP Issuer:      ${var.sso_saml_issuer}"
                echo "  IdP SSO URL:     ${var.sso_saml_url}"
                echo "  Certificate:     [provided via variable]"
                echo "  SSO Enforcement: ENABLED"
                echo "  Admin Fallback:  ENABLED"
                echo ""
                echo "Validation: Log in via SSO to confirm configuration."
                echo "============================================================"
              EOT
            }
            }


"1.2":
"1.2":
  terraform:
  terraform:
    lang: "hcl"
    lang: "hcl"
    filename: "hth-twilio-1.02-enforce-two-factor-auth.tf"
    filename: "hth-twilio-1.02-enforce-two-factor-auth.tf"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/twilio/terraform/hth-twilio-1.02-enforce-two-factor-auth.tf"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/twilio/terraform/hth-twilio-1.02-enforce-two-factor-auth.tf"
    excerpts:
    excerpts:
      terraform:
      terraform:
        content: |
        content: |
            # NOTE: Twilio Console 2FA enforcement is not configurable via the
            # twilio/twilio Terraform provider as of v0.18.x. 2FA must be required
            # via the Twilio Console (Account > Security) or the Organizations API.
            #
            # This null_resource documents the expected 2FA state and validates
            # that enforcement is active.
          
            resource "null_resource" "enforce_2fa_validation" {
            triggers = {
              profile_level = var.profile_level
            }
          
            provisioner "local-exec" {
              command = <<-EOT
                echo "============================================================"
                echo "HTH Twilio 1.2: Two-Factor Authentication Enforcement"
                echo "============================================================"
                echo ""
                echo "2FA must be enforced manually in the Twilio Console:"
                echo "  Account > Security > Require two-factor authentication"
                echo ""
                echo "Expected configuration (Profile Level ${var.profile_level}):"
                echo "  2FA Required:        YES (all users)"
                echo "  Authenticator Apps:  ALLOWED"
                echo "  Authy:               ALLOWED"
                if [ "${var.profile_level}" -ge 2 ]; then
                  echo "  Hardware Keys:       REQUIRED (admin accounts)"
                else
                  echo "  Hardware Keys:       RECOMMENDED (admin accounts)"
                fi
                echo ""
                echo "Validation: Verify at Account > Security that 2FA is required."
                echo "============================================================"
              EOT
            }
            }
            # NOTE: Twilio Console 2FA enforcement is not configurable via the
            # twilio/twilio Terraform provider as of v0.18.x. 2FA must be required
            # via the Twilio Console (Account > Security) or the Organizations API.
            #
            # This null_resource documents the expected 2FA state and validates
            # that enforcement is active.
          
            resource "null_resource" "enforce_2fa_validation" {
            triggers = {
              profile_level = var.profile_level
            }
          
            provisioner "local-exec" {
              command = <<-EOT
                echo "============================================================"
                echo "HTH Twilio 1.2: Two-Factor Authentication Enforcement"
                echo "============================================================"
                echo ""
                echo "2FA must be enforced manually in the Twilio Console:"
                echo "  Account > Security > Require two-factor authentication"
                echo ""
                echo "Expected configuration (Profile Level ${var.profile_level}):"
                echo "  2FA Required:        YES (all users)"
                echo "  Authenticator Apps:  ALLOWED"
                echo "  Authy:               ALLOWED"
                if [ "${var.profile_level}" -ge 2 ]; then
                  echo "  Hardware Keys:       REQUIRED (admin accounts)"
                else
                  echo "  Hardware Keys:       RECOMMENDED (admin accounts)"
                fi
                echo ""
                echo "Validation: Verify at Account > Security that 2FA is required."
                echo "============================================================"
              EOT
            }
            }


"2.1":
"2.1":
  terraform:
  terraform:
    lang: "hcl"
    lang: "hcl"
    filename: "hth-twilio-2.01-configure-user-roles.tf"
    filename: "hth-twilio-2.01-configure-user-roles.tf"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/twilio/terraform/hth-twilio-2.01-configure-user-roles.tf"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/twilio/terraform/hth-twilio-2.01-configure-user-roles.tf"
    excerpts:
    excerpts:
      terraform:
      terraform:
        content: |
        content: |
            # Enforce least-privilege by documenting and validating role assignments.
            # Twilio user role management is primarily done via Console or the
            # Organizations API. This resource validates the expected state.
          
            resource "null_resource" "user_role_validation" {
            triggers = {
              profile_level       = var.profile_level
              restricted_role_map = jsonencode(var.restricted_role_users)
            }
          
            provisioner "local-exec" {
              command = <<-EOT
                echo "============================================================"
                echo "HTH Twilio 2.1: User Role Configuration"
                echo "============================================================"
                echo ""
                echo "Role assignment must be managed in the Twilio Console:"
                echo "  Account > Manage Users"
                echo ""
                echo "Principle: Least privilege -- assign the minimum role needed."
                echo ""
                echo "Available roles:"
                echo "  - Owner         (limit to 2-3 users)"
                echo "  - Administrator (limit, require 2FA)"
                echo "  - Developer     (default for engineering)"
                echo "  - Billing       (finance only)"
                echo "  - Support       (support staff only)"
                echo ""
                echo "Validation: Review user list and confirm no excess admin access."
                echo "============================================================"
              EOT
            }
            }
            # Enforce least-privilege by documenting and validating role assignments.
            # Twilio user role management is primarily done via Console or the
            # Organizations API. This resource validates the expected state.
          
            resource "null_resource" "user_role_validation" {
            triggers = {
              profile_level       = var.profile_level
              restricted_role_map = jsonencode(var.restricted_role_users)
            }
          
            provisioner "local-exec" {
              command = <<-EOT
                echo "============================================================"
                echo "HTH Twilio 2.1: User Role Configuration"
                echo "============================================================"
                echo ""
                echo "Role assignment must be managed in the Twilio Console:"
                echo "  Account > Manage Users"
                echo ""
                echo "Principle: Least privilege -- assign the minimum role needed."
                echo ""
                echo "Available roles:"
                echo "  - Owner         (limit to 2-3 users)"
                echo "  - Administrator (limit, require 2FA)"
                echo "  - Developer     (default for engineering)"
                echo "  - Billing       (finance only)"
                echo "  - Support       (support staff only)"
                echo ""
                echo "Validation: Review user list and confirm no excess admin access."
                echo "============================================================"
              EOT
            }
            }


"2.2":
"2.2":
  terraform:
  terraform:
    lang: "hcl"
    lang: "hcl"
    filename: "hth-twilio-2.02-configure-subaccounts.tf"
    filename: "hth-twilio-2.02-configure-subaccounts.tf"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/twilio/terraform/hth-twilio-2.02-configure-subaccounts.tf"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/twilio/terraform/hth-twilio-2.02-configure-subaccounts.tf"
    excerpts:
    excerpts:
      terraform:
      terraform:
        content: |
        content: |
            # Create isolated subaccounts for environment and application separation.
            # Each subaccount gets its own credentials, usage limits, and audit trail.
          
            resource "twilio_api_accounts" "subaccount" {
            count = var.profile_level >= 2 ? length(var.subaccounts) : 0
          
            friendly_name = var.subaccounts[count.index]
            }
            # Create isolated subaccounts for environment and application separation.
            # Each subaccount gets its own credentials, usage limits, and audit trail.
          
            resource "twilio_api_accounts" "subaccount" {
            count = var.profile_level >= 2 ? length(var.subaccounts) : 0
          
            friendly_name = var.subaccounts[count.index]
            }


"2.3":
"2.3":
  terraform:
  terraform:
    lang: "hcl"
    lang: "hcl"
    filename: "hth-twilio-2.03-limit-admin-access.tf"
    filename: "hth-twilio-2.03-limit-admin-access.tf"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/twilio/terraform/hth-twilio-2.03-limit-admin-access.tf"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/twilio/terraform/hth-twilio-2.03-limit-admin-access.tf"
    excerpts:
    excerpts:
      terraform:
      terraform:
        content: |
        content: |
            # Admin access restriction is managed via the Twilio Console.
            # This resource documents the expected admin posture and serves
            # as a Terraform-tracked validation checkpoint.
          
            resource "null_resource" "limit_admin_access_validation" {
            triggers = {
              profile_level = var.profile_level
            }
          
            provisioner "local-exec" {
              command = <<-EOT
                echo "============================================================"
                echo "HTH Twilio 2.3: Limit Admin Access"
                echo "============================================================"
                echo ""
                echo "Admin access must be minimized in the Twilio Console:"
                echo "  Account > Manage Users"
                echo ""
                echo "Expected configuration (Profile Level ${var.profile_level}):"
                echo "  Owner accounts:      Maximum 2-3 users"
                echo "  Admin accounts:      Minimum necessary"
                echo "  Admin 2FA:           REQUIRED"
                echo "  Admin activity:      MONITORED"
                echo ""
                echo "Actions:"
                echo "  1. Inventory all Owner and Administrator accounts"
                echo "  2. Remove unnecessary admin privileges"
                echo "  3. Confirm 2FA is active for all admins"
                echo "  4. Enable admin activity monitoring"
                echo ""
                echo "Validation: Confirm max 2-3 Owner accounts exist."
                echo "============================================================"
              EOT
            }
            }
            # Admin access restriction is managed via the Twilio Console.
            # This resource documents the expected admin posture and serves
            # as a Terraform-tracked validation checkpoint.
          
            resource "null_resource" "limit_admin_access_validation" {
            triggers = {
              profile_level = var.profile_level
            }
          
            provisioner "local-exec" {
              command = <<-EOT
                echo "============================================================"
                echo "HTH Twilio 2.3: Limit Admin Access"
                echo "============================================================"
                echo ""
                echo "Admin access must be minimized in the Twilio Console:"
                echo "  Account > Manage Users"
                echo ""
                echo "Expected configuration (Profile Level ${var.profile_level}):"
                echo "  Owner accounts:      Maximum 2-3 users"
                echo "  Admin accounts:      Minimum necessary"
                echo "  Admin 2FA:           REQUIRED"
                echo "  Admin activity:      MONITORED"
                echo ""
                echo "Actions:"
                echo "  1. Inventory all Owner and Administrator accounts"
                echo "  2. Remove unnecessary admin privileges"
                echo "  3. Confirm 2FA is active for all admins"
                echo "  4. Enable admin activity monitoring"
                echo ""
                echo "Validation: Confirm max 2-3 Owner accounts exist."
                echo "============================================================"
              EOT
            }
            }


"3.1":
"3.1":
  terraform:
  terraform:
    lang: "hcl"
    lang: "hcl"
    filename: "hth-twilio-3.01-configure-api-key-security.tf"
    filename: "hth-twilio-3.01-configure-api-key-security.tf"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/twilio/terraform/hth-twilio-3.01-configure-api-key-security.tf"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/twilio/terraform/hth-twilio-3.01-configure-api-key-security.tf"
    excerpts:
    excerpts:
      terraform:
      terraform:
        content: |
        content: |
            # Create a standard API key to replace Account SID / Auth Token usage.
            # API keys are scoped, rotatable, and revocable -- the Account Auth Token
            # is a master credential that should never be used in application code.
          
            resource "twilio_api_accounts_keys" "hardened_api_key" {
            count = var.create_api_key ? 1 : 0
          
            friendly_name = var.api_key_friendly_name
            }
          
            # L2+: Create a dedicated API key per subaccount for credential isolation
            resource "twilio_api_accounts_keys" "subaccount_api_key" {
            count = var.profile_level >= 2 ? length(var.subaccounts) : 0
          
            account_sid   = twilio_api_accounts.subaccount[count.index].sid
            friendly_name = "hth-${var.subaccounts[count.index]}-api-key"
            }
            # Create a standard API key to replace Account SID / Auth Token usage.
            # API keys are scoped, rotatable, and revocable -- the Account Auth Token
            # is a master credential that should never be used in application code.
          
            resource "twilio_api_accounts_keys" "hardened_api_key" {
            count = var.create_api_key ? 1 : 0
          
            friendly_name = var.api_key_friendly_name
            }
          
            # L2+: Create a dedicated API key per subaccount for credential isolation
            resource "twilio_api_accounts_keys" "subaccount_api_key" {
            count = var.profile_level >= 2 ? length(var.subaccounts) : 0
          
            account_sid   = twilio_api_accounts.subaccount[count.index].sid
            friendly_name = "hth-${var.subaccounts[count.index]}-api-key"
            }


"3.2":
"3.2":
  terraform:
  terraform:
    lang: "hcl"
    lang: "hcl"
    filename: "hth-twilio-3.02-configure-webhook-security.tf"
    filename: "hth-twilio-3.02-configure-webhook-security.tf"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/twilio/terraform/hth-twilio-3.02-configure-webhook-security.tf"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/twilio/terraform/hth-twilio-3.02-configure-webhook-security.tf"
    excerpts:
    excerpts:
      terraform:
      terraform:
        content: |
        content: |
            # Webhook security requires signature validation and HTTPS enforcement.
            # The Twilio provider does not have a native webhook validation resource,
            # so this documents the expected security posture and provides a
            # validation checkpoint.
          
            resource "null_resource" "webhook_security_validation" {
            count = var.profile_level >= 2 ? 1 : 0
          
            triggers = {
              profile_level      = var.profile_level
              allowed_ip_cidrs   = jsonencode(var.webhook_allowed_ip_cidrs)
            }
          
            provisioner "local-exec" {
              command = <<-EOT
                echo "============================================================"
                echo "HTH Twilio 3.2: Webhook Security Configuration"
                echo "============================================================"
                echo ""
                echo "Webhook security must be enforced in application code and"
                echo "infrastructure configuration."
                echo ""
                echo "Required controls:"
                echo "  1. Validate X-Twilio-Signature on ALL webhook endpoints"
                echo "  2. Use HTTPS only for callback URLs"
                echo "  3. Reject requests with invalid signatures"
                echo ""
                if [ "${var.profile_level}" -ge 2 ]; then
                  echo "L2+ controls:"
                  echo "  4. Implement IP allowlisting for webhook origins"
                  echo "  5. Monitor webhook endpoints for anomalies"
                  echo "  6. Rotate webhook signing secrets regularly"
                fi
                echo ""
                echo "Twilio webhook source IPs are published at:"
                echo "  https://www.twilio.com/docs/sip-trunking/ip-addresses"
                echo ""
                echo "Validation: Send a test webhook and confirm signature check."
                echo "============================================================"
              EOT
            }
            }
            # Webhook security requires signature validation and HTTPS enforcement.
            # The Twilio provider does not have a native webhook validation resource,
            # so this documents the expected security posture and provides a
            # validation checkpoint.
          
            resource "null_resource" "webhook_security_validation" {
            count = var.profile_level >= 2 ? 1 : 0
          
            triggers = {
              profile_level      = var.profile_level
              allowed_ip_cidrs   = jsonencode(var.webhook_allowed_ip_cidrs)
            }
          
            provisioner "local-exec" {
              command = <<-EOT
                echo "============================================================"
                echo "HTH Twilio 3.2: Webhook Security Configuration"
                echo "============================================================"
                echo ""
                echo "Webhook security must be enforced in application code and"
                echo "infrastructure configuration."
                echo ""
                echo "Required controls:"
                echo "  1. Validate X-Twilio-Signature on ALL webhook endpoints"
                echo "  2. Use HTTPS only for callback URLs"
                echo "  3. Reject requests with invalid signatures"
                echo ""
                if [ "${var.profile_level}" -ge 2 ]; then
                  echo "L2+ controls:"
                  echo "  4. Implement IP allowlisting for webhook origins"
                  echo "  5. Monitor webhook endpoints for anomalies"
                  echo "  6. Rotate webhook signing secrets regularly"
                fi
                echo ""
                echo "Twilio webhook source IPs are published at:"
                echo "  https://www.twilio.com/docs/sip-trunking/ip-addresses"
                echo ""
                echo "Validation: Send a test webhook and confirm signature check."
                echo "============================================================"
              EOT
            }
            }


