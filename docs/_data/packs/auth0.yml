# AUTO-GENERATED by scripts/sync-packs-to-data.sh â€” do not edit manually
# Generated: 2026-02-18T20:45:20Z

"1.1":
  terraform:
    lang: "hcl"
    filename: "hth-auth0-1.01-enable-brute-force-protection.tf"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/auth0/terraform/hth-auth0-1.01-enable-brute-force-protection.tf"
    excerpts:
      terraform:
        content: |
            resource "auth0_attack_protection" "brute_force" {
            brute_force_protection {
              enabled      = true
              max_attempts = 5
              mode         = "count_per_identifier_and_ip"
              shields      = ["block", "user_notification"]
              allowlist    = []
            }
            }
  api:
    lang: "bash"
    filename: "hth-auth0-1.01-enable-brute-force-protection.sh"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/auth0/api/hth-auth0-1.01-enable-brute-force-protection.sh"
    excerpts:
      api-enable-brute-force:
        content: |
            # Enable brute force protection with hardened thresholds
            info "1.1 Enabling brute force protection..."
            RESPONSE=$(a0_patch "/attack-protection/brute-force-protection" '{
            "enabled": true,
            "shields": ["block", "user_notification"],
            "mode": "count_per_identifier_and_ip",
            "max_attempts": 5
            }') || {
            fail "1.1 Failed to enable brute force protection"
            increment_failed; summary; exit 0
            }
  sigma:
    - lang: "yaml"
      filename: "hth-auth0-1.01-enable-brute-force-protection.yml"
      source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/auth0/siem/sigma/hth-auth0-1.01-enable-brute-force-protection.yml"
      excerpts:
        detection:
          content: |
              detection:
                selection:
                    type: 'sapi'
                    description|contains: 'brute-force-protection'
                filter_disable:
                    details.request.body|contains: '"enabled":false'
                condition: selection and filter_disable
              fields:
                - date
                - type
                - description
                - user_name
                - ip

"1.2":
  terraform:
    lang: "hcl"
    filename: "hth-auth0-1.02-enable-suspicious-ip-throttling.tf"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/auth0/terraform/hth-auth0-1.02-enable-suspicious-ip-throttling.tf"
    excerpts:
      terraform:
        content: |
            resource "auth0_attack_protection" "suspicious_ip" {
            suspicious_ip_throttling {
              enabled   = true
              shields   = ["admin_notification", "block"]
              allowlist = []
          
              pre_login {
                max_attempts = 100
                rate         = 864000
              }
          
              pre_user_registration {
                max_attempts = 50
                rate         = 1200000
              }
            }
            }
  api:
    lang: "bash"
    filename: "hth-auth0-1.02-enable-suspicious-ip-throttling.sh"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/auth0/api/hth-auth0-1.02-enable-suspicious-ip-throttling.sh"
    excerpts:
      api-enable-ip-throttling:
        content: |
            # Enable suspicious IP throttling
            info "1.2 Enabling suspicious IP throttling..."
            RESPONSE=$(a0_patch "/attack-protection/suspicious-ip-throttling" '{
            "enabled": true,
            "shields": ["admin_notification", "block"],
            "stage": {
              "pre-login": { "max_attempts": 100, "rate": 864000 },
              "pre-user-registration": { "max_attempts": 50, "rate": 1200000 }
            }
            }') || {
            fail "1.2 Failed to enable suspicious IP throttling"
            increment_failed; summary; exit 0
            }

"1.3":
  terraform:
    lang: "hcl"
    filename: "hth-auth0-1.03-enable-breached-password-detection.tf"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/auth0/terraform/hth-auth0-1.03-enable-breached-password-detection.tf"
    excerpts:
      terraform:
        content: |
            resource "auth0_attack_protection" "breached_password" {
            breached_password_detection {
              enabled                      = true
              method                       = "standard"
              shields                      = ["admin_notification", "block"]
              admin_notification_frequency = ["immediately"]
          
              pre_user_registration {
                shields = ["block"]
              }
            }
            }
  api:
    lang: "bash"
    filename: "hth-auth0-1.03-enable-breached-password-detection.sh"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/auth0/api/hth-auth0-1.03-enable-breached-password-detection.sh"
    excerpts:
      api-enable-breached-pw:
        content: |
            # Enable breached password detection
            info "1.3 Enabling breached password detection..."
            RESPONSE=$(a0_patch "/attack-protection/breached-password-detection" '{
            "enabled": true,
            "method": "standard",
            "shields": ["admin_notification", "block"],
            "admin_notification_frequency": ["immediately"],
            "stage": {
              "pre-user-registration": { "shields": ["block"] }
            }
            }') || {
            fail "1.3 Failed to enable breached password detection (may require Professional plan)"
            increment_failed; summary; exit 0
            }

"1.4":
  terraform:
    lang: "hcl"
    filename: "hth-auth0-1.04-configure-bot-detection.tf"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/auth0/terraform/hth-auth0-1.04-configure-bot-detection.tf"
    excerpts:
      terraform:
        content: |
            resource "auth0_attack_protection" "bot_detection" {
            bot_detection {
              bot_detection_level             = "medium"
              challenge_password_policy       = "when_risky"
              challenge_passwordless_policy   = "when_risky"
              challenge_password_reset_policy = "when_risky"
              monitoring_mode_enabled         = false
              allowlist                       = []
            }
            }
  api:
    lang: "bash"
    filename: "hth-auth0-1.04-configure-bot-detection.sh"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/auth0/api/hth-auth0-1.04-configure-bot-detection.sh"
    excerpts:
      api-configure-bot-detection:
        content: |
            # Configure bot detection with risk-based challenges
            info "1.4 Configuring bot detection..."
            RESPONSE=$(a0_patch "/attack-protection/bot-detection" '{
            "bot_detection_level": "medium",
            "challenge_password_policy": "when_risky",
            "challenge_passwordless_policy": "when_risky",
            "challenge_password_reset_policy": "when_risky",
            "monitoring_mode_enabled": false
            }') || {
            fail "1.4 Failed to configure bot detection"
            increment_failed; summary; exit 0
            }

"2.1":
  terraform:
    lang: "hcl"
    filename: "hth-auth0-2.01-enforce-password-policies.tf"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/auth0/terraform/hth-auth0-2.01-enforce-password-policies.tf"
    excerpts:
      terraform:
        content: |
            resource "auth0_connection" "database" {
            name     = "Username-Password-Authentication"
            strategy = "auth0"
          
            options {
              password_policy        = "excellent"
              brute_force_protection = true
          
              password_complexity_options {
                min_length = 14
              }
          
              password_history {
                enable = true
                size   = 5
              }
          
              password_dictionary {
                enable = true
              }
          
              password_no_personal_info {
                enable = true
              }
            }
            }
  api:
    lang: "bash"
    filename: "hth-auth0-2.01-enforce-password-policies.sh"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/auth0/api/hth-auth0-2.01-enforce-password-policies.sh"
    excerpts:
      api-set-password-policy:
        content: |
            # Set strong password policy on database connection
            info "2.1 Setting password policy to 'excellent' with history and dictionary..."
            RESPONSE=$(a0_patch "/connections/${CONNECTION_ID}" '{
            "options": {
              "password_policy": "excellent",
              "brute_force_protection": true,
              "password_complexity_options": { "min_length": 14 },
              "password_history": { "enable": true, "size": 5 },
              "password_dictionary": { "enable": true },
              "password_no_personal_info": { "enable": true }
            }
            }') || {
            fail "2.1 Failed to update password policy"
            increment_failed; summary; exit 0
            }

"2.2":
  terraform:
    lang: "hcl"
    filename: "hth-auth0-2.02-enable-mfa.tf"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/auth0/terraform/hth-auth0-2.02-enable-mfa.tf"
    excerpts:
      terraform:
        content: |
            resource "auth0_guardian" "mfa" {
            policy        = "all-applications"
            otp           = true
            recovery_code = true
          
            webauthn_roaming {
              user_verification = "required"
            }
          
            webauthn_platform {}
            }
  api:
    lang: "bash"
    filename: "hth-auth0-2.02-enable-mfa.sh"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/auth0/api/hth-auth0-2.02-enable-mfa.sh"
    excerpts:
      api-enable-mfa:
        content: |
            # Set MFA policy to all-applications and enable OTP + WebAuthn
            info "2.2 Setting MFA policy to 'all-applications'..."
            a0_put "/guardian/policies" '["all-applications"]' || {
            fail "2.2 Failed to set MFA policy"
            increment_failed; summary; exit 0
            }
          
            info "2.2 Enabling OTP factor..."
            a0_put "/guardian/factors/otp" '{"enabled": true}' || warn "2.2 Failed to enable OTP"
          
            info "2.2 Enabling WebAuthn (security keys)..."
            a0_put "/guardian/factors/webauthn-roaming" '{"enabled": true}' || warn "2.2 Failed to enable WebAuthn roaming"
          
            info "2.2 Enabling WebAuthn (biometrics)..."
            a0_put "/guardian/factors/webauthn-platform" '{"enabled": true}' || warn "2.2 Failed to enable WebAuthn platform"
          
            info "2.2 Enabling recovery codes..."
            a0_put "/guardian/factors/recovery-code" '{"enabled": true}' || warn "2.2 Failed to enable recovery codes"
  sigma:
    - lang: "yaml"
      filename: "hth-auth0-2.02-enable-mfa.yml"
      source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/auth0/siem/sigma/hth-auth0-2.02-enable-mfa.yml"
      excerpts:
        detection:
          content: |
              detection:
                selection:
                    type: 'sapi'
                    description|contains: 'guardian/policies'
                filter_weaken:
                    details.request.body|contains:
                        - '"never"'
                        - '"confidence-score"'
                condition: selection and filter_weaken
              fields:
                - date
                - type
                - description
                - user_name
                - ip

"3.1":
  terraform:
    lang: "hcl"
    filename: "hth-auth0-3.01-restrict-admin-access.tf"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/auth0/terraform/hth-auth0-3.01-restrict-admin-access.tf"
    excerpts:
      terraform:
        content: |
            resource "auth0_tenant" "hardened" {
            friendly_name       = var.tenant_name
            session_lifetime    = 8
            idle_session_lifetime = 1
          
            flags {
              disable_clickjack_protection_headers  = false
              enable_public_signup_user_exists_error = false
              revoke_refresh_token_grant            = true
              enable_sso                            = true
            }
          
            session_cookie {
              mode = "non-persistent"
            }
            }
  api:
    lang: "bash"
    filename: "hth-auth0-3.01-restrict-admin-access.sh"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/auth0/api/hth-auth0-3.01-restrict-admin-access.sh"
    excerpts:
      api-harden-tenant:
        content: |
            # Harden tenant session and security settings
            info "3.1 Applying hardened tenant settings..."
            RESPONSE=$(a0_patch "/tenants/settings" '{
            "session_lifetime": 8,
            "idle_session_lifetime": 1,
            "flags": {
              "disable_clickjack_protection_headers": false,
              "enable_public_signup_user_exists_error": false,
              "revoke_refresh_token_grant": true,
              "enable_sso": true
            },
            "session_cookie": { "mode": "non-persistent" }
            }') || {
            fail "3.1 Failed to update tenant settings"
            increment_failed; summary; exit 0
            }
  sigma:
    - lang: "yaml"
      filename: "hth-auth0-3.01-restrict-admin-access.yml"
      source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/auth0/siem/sigma/hth-auth0-3.01-restrict-admin-access.yml"
      excerpts:
        detection:
          content: |
              detection:
                selection:
                    type: 'sapi'
                    description|contains: 'tenants/settings'
                condition: selection
              fields:
                - date
                - type
                - description
                - user_name
                - ip

"4.2":
  terraform:
    lang: "hcl"
    filename: "hth-auth0-4.02-secure-application-config.tf"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/auth0/terraform/hth-auth0-4.02-secure-application-config.tf"
    excerpts:
      terraform:
        content: |
            resource "auth0_client" "secure_app" {
            name     = var.app_name
            app_type = "regular_web"
          
            oidc_conformant = true
          
            jwt_configuration {
              lifetime_in_seconds = 300
              alg                 = "RS256"
            }
          
            refresh_token {
              rotation_type       = "rotating"
              expiration_type     = "expiring"
              token_lifetime      = 2592000
              idle_token_lifetime = 1296000
              leeway              = 0
            }
            }
  api:
    lang: "bash"
    filename: "hth-auth0-4.02-secure-application-config.sh"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/auth0/api/hth-auth0-4.02-secure-application-config.sh"
    excerpts:
      api-audit-apps:
        content: |
            # Audit application token settings and OIDC conformance
            CLIENTS=$(a0_get "/clients?fields=name,client_id,app_type,oidc_conformant,jwt_configuration,refresh_token&include_fields=true") || {
            fail "4.2 Unable to retrieve applications"
            increment_failed; summary; exit 0
            }
          
            CLIENT_COUNT=$(echo "${CLIENTS}" | jq 'length')
            info "4.2 Found ${CLIENT_COUNT} application(s)"
          
            ISSUES=0
            while IFS= read -r client; do
            NAME=$(echo "${client}" | jq -r '.name')
            OIDC=$(echo "${client}" | jq -r '.oidc_conformant // false')
            TOKEN_TTL=$(echo "${client}" | jq -r '.jwt_configuration.lifetime_in_seconds // 36000')
            ROTATION=$(echo "${client}" | jq -r '.refresh_token.rotation_type // "non-rotating"')
          
            [ "${OIDC}" != "true" ] && { warn "4.2 '${NAME}' is not OIDC conformant"; ISSUES=$((ISSUES + 1)); }
            [ "${TOKEN_TTL}" -gt 3600 ] && { warn "4.2 '${NAME}' access token TTL (${TOKEN_TTL}s) exceeds 1 hour"; ISSUES=$((ISSUES + 1)); }
            [ "${ROTATION}" != "rotating" ] && { warn "4.2 '${NAME}' refresh tokens are not rotating"; ISSUES=$((ISSUES + 1)); }
            done < <(echo "${CLIENTS}" | jq -c '.[]')

"5.1":
  terraform:
    lang: "hcl"
    filename: "hth-auth0-5.01-enable-logging.tf"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/auth0/terraform/hth-auth0-5.01-enable-logging.tf"
    excerpts:
      terraform:
        content: |
            resource "auth0_log_stream" "siem" {
            name   = "SIEM Log Stream"
            type   = "http"
            status = "active"
          
            sink {
              http_endpoint       = var.siem_webhook_url
              http_content_type   = "application/json"
              http_content_format = "JSONOBJECT"
              http_authorization  = "Bearer ${var.siem_token}"
            }
            }
  api:
    lang: "bash"
    filename: "hth-auth0-5.01-enable-logging.sh"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/auth0/api/hth-auth0-5.01-enable-logging.sh"
    excerpts:
      api-audit-log-streams:
        content: |
            # Audit log stream configuration
            STREAMS=$(a0_get "/log-streams") || {
            fail "5.1 Unable to retrieve log streams"
            increment_failed; summary; exit 0
            }
          
            STREAM_COUNT=$(echo "${STREAMS}" | jq 'length')
            ACTIVE_COUNT=$(echo "${STREAMS}" | jq '[.[] | select(.status == "active")] | length')
          
            info "5.1 Found ${STREAM_COUNT} log stream(s), ${ACTIVE_COUNT} active"
          
            if [ "${ACTIVE_COUNT}" -gt 0 ]; then
            pass "5.1 Active log stream(s) configured"
            echo "${STREAMS}" | jq -r '.[] | "  - \(.name) (\(.type)): \(.status)"'
            else
            warn "5.1 No active log streams -- configure SIEM integration (requires Professional plan)"
            fi
  sigma:
    - lang: "yaml"
      filename: "hth-auth0-5.01-enable-logging.yml"
      source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/auth0/siem/sigma/hth-auth0-5.01-enable-logging.yml"
      excerpts:
        detection:
          content: |
              detection:
                selection:
                    type: 'sapi'
                    description|contains: 'log-streams'
                filter_action:
                    details.request.method|contains:
                        - 'delete'
                        - 'patch'
                condition: selection and filter_action
              fields:
                - date
                - type
                - description
                - user_name
                - ip

