# AUTO-GENERATED by scripts/sync-packs-to-data.sh â€” do not edit manually
# Generated: 2026-02-19T20:10:15Z

"1.1":
  terraform:
    lang: "hcl"
    filename: "hth-slack-1.01-okta-saml-config.tf"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/slack/terraform/hth-slack-1.01-okta-saml-config.tf"
    excerpts:
      terraform-okta-saml:
        content: |
            resource "okta_app_saml" "slack" {
            label             = "Slack"
            preconfigured_app = "slack"
          
            saml_version = "2.0"
          
            attribute_statements {
              name      = "User.Email"
              type      = "EXPRESSION"
              values    = ["user.email"]
            }
            }
          
            resource "okta_app_user_base_schema_property" "slack_user" {
            app_id      = okta_app_saml.slack.id
            index       = "userName"
            title       = "Username"
            type        = "string"
            master      = "PROFILE_MASTER"
            }
  sdk:
    lang: "python"
    filename: "hth-slack-1.01-scim-user-listing.py"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/slack/sdk/hth-slack-1.01-scim-user-listing.py"
    excerpts:
      sdk-scim-user-listing:
        content: |
            import requests
          
            headers = {
              'Authorization': f'Bearer {SLACK_ADMIN_TOKEN}',
              'Content-Type': 'application/json'
            }
          
            # List users via SCIM
            response = requests.get(
              'https://api.slack.com/scim/v1/Users',
              headers=headers
            )
          
            users = response.json()
            for user in users.get('Resources', []):
              print(f"User: {user['userName']}, Active: {user['active']}")

"3.1":
  api:
    lang: "python"
    filename: "hth-slack-3.01-audit-approved-apps.py"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/slack/api/hth-slack-3.01-audit-approved-apps.py"
    excerpts:
      api-audit-approved-apps:
        content: |
            import requests
          
            headers = {
              'Authorization': f'Bearer {SLACK_ADMIN_TOKEN}',
              'Content-Type': 'application/json'
            }
          
            # List approved apps
            response = requests.get(
              'https://slack.com/api/admin.apps.approved.list',
              headers=headers
            )
          
            approved_apps = response.json()
            for app in approved_apps.get('approved_apps', []):
              print(f"App: {app['name']}, Scopes: {app.get('scopes', [])}")
          
            # List restricted apps
            response = requests.get(
              'https://slack.com/api/admin.apps.restricted.list',
              headers=headers
            )

"4.1":
  cli:
    lang: "regex"
    filename: "hth-slack-4.01-dlp-regex-patterns.regex"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/slack/cli/hth-slack-4.01-dlp-regex-patterns.regex"
    excerpts:
      cli-dlp-regex-patterns:
        content: |
            # Credit Card Numbers
            \b(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|3[47][0-9]{13}|6(?:011|5[0-9]{2})[0-9]{12})\b
          
            # SSN
            \b\d{3}-\d{2}-\d{4}\b
          
            # AWS Access Key
            \bAKIA[A-Z0-9]{16}\b
          
            # Generic API Key
            \b[A-Za-z0-9]{32,}\b

"5.1":
  sdk:
    lang: "python"
    filename: "hth-slack-5.01-audit-logs-api.py"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/slack/sdk/hth-slack-5.01-audit-logs-api.py"
    excerpts:
      sdk-audit-logs-api:
        content: |
            import requests
          
            headers = {
              'Authorization': f'Bearer {SLACK_AUDIT_TOKEN}',
              'Content-Type': 'application/json'
            }
          
            params = {
              'limit': 100,
              'action': 'user_login',
              'oldest': 1704067200
            }
          
            response = requests.get(
              'https://api.slack.com/audit/v1/logs',
              headers=headers,
              params=params
            )
          
            logs = response.json()
            for entry in logs.get('entries', []):
              print(f"Action: {entry['action']}, User: {entry.get('actor', {}).get('user', {}).get('email')}")
  db:
    lang: "spl"
    filename: "hth-slack-5.01-siem-splunk-queries.spl"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/slack/db/hth-slack-5.01-siem-splunk-queries.spl"
    excerpts:
      db-siem-splunk-queries:
        content: |
            # Failed login attempts
            index=slack sourcetype=slack:audit action="user_login_failed"
            | stats count by actor.user.email
            | where count > 5
          
            # Admin role changes
            index=slack sourcetype=slack:audit action="role_change_to_admin"
            | table _time actor.user.email entity.user.email
          
            # App installations
            index=slack sourcetype=slack:audit action="app_installed"
            | table _time actor.user.email entity.app.name

