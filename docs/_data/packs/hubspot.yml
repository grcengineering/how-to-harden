# AUTO-GENERATED by scripts/sync-packs-to-data.sh â€” do not edit manually
# Generated: 2026-02-19T16:51:31Z

"3.1":
  cli:
    lang: "bash"
    filename: "hth-hubspot-3.01-audit-existing-tokens.sh"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/hubspot/cli/hth-hubspot-3.01-audit-existing-tokens.sh"
    excerpts:
      cli-list-private-apps:
        content: |
            # List private apps via API
            curl -X GET "https://api.hubapi.com/integrations/v1/apps" \
            -H "Authorization: Bearer ${ACCESS_TOKEN}"

"3.2":
  sdk:
    lang: "python"
    filename: "hth-hubspot-3.02-monitor-rate-limits.py"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/hubspot/sdk/hth-hubspot-3.02-monitor-rate-limits.py"
    excerpts:
      sdk-monitor-rate-limits:
        content: |
            # Monitor rate limit headers
            response = requests.get(url, headers=headers)
            remaining = response.headers.get('X-HubSpot-RateLimit-Remaining')
            daily_remaining = response.headers.get('X-HubSpot-RateLimit-Daily-Remaining')

"5.1":
  db:
    lang: "sql"
    filename: "hth-hubspot-5.01-detection-queries.sql"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/hubspot/db/hth-hubspot-5.01-detection-queries.sql"
    excerpts:
      db-detect-bulk-access:
        content: |
            -- Detect bulk contact access
            SELECT user_id, COUNT(*) as view_count
            FROM hubspot_activity_log
            WHERE action = 'contact.view'
            AND timestamp > NOW() - INTERVAL '1 hour'
            GROUP BY user_id
            HAVING COUNT(*) > 100;
          
            -- Detect API key creation
            SELECT *
            FROM hubspot_activity_log
            WHERE action = 'private_app.created'
            AND timestamp > NOW() - INTERVAL '24 hours';
          
            -- Detect permission changes
            SELECT *
            FROM hubspot_activity_log
            WHERE action LIKE '%permission%'
            AND timestamp > NOW() - INTERVAL '7 days';

