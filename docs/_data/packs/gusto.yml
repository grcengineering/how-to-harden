# AUTO-GENERATED by scripts/sync-packs-to-data.sh â€” do not edit manually
# Generated: 2026-02-19T16:51:29Z

"4.1":
  db:
    lang: "sql"
    filename: "hth-gusto-4.01-detect-anomalies.sql"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/gusto/db/hth-gusto-4.01-detect-anomalies.sql"
    excerpts:
      db-detect-anomalies:
        content: |
            -- Detect bank account changes
            SELECT admin_email, employee_name, change_type
            FROM gusto_activity
            WHERE action = 'bank_account_change'
            AND timestamp > NOW() - INTERVAL '7 days';
          
            -- Detect unusual admin activity
            SELECT admin_email, action, COUNT(*) as actions
            FROM gusto_activity
            WHERE timestamp > NOW() - INTERVAL '24 hours'
            GROUP BY admin_email, action
            HAVING COUNT(*) > 50;

