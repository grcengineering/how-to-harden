# AUTO-GENERATED by scripts/sync-packs-to-data.sh â€” do not edit manually
# Generated: 2026-02-19T16:51:03Z

"4.1":
  db:
    lang: "sql"
    filename: "hth-adp-4.01-detect-anomalies.sql"
    source_url: "https://github.com/grcengineering/how-to-harden/blob/main/packs/adp/db/hth-adp-4.01-detect-anomalies.sql"
    excerpts:
      db-detect-anomalies:
        content: |
            -- Detect unusual payroll changes
            SELECT user_id, action, employee_id
            FROM adp_audit_log
            WHERE action IN ('bank_account_change', 'direct_deposit_change')
            AND timestamp > NOW() - INTERVAL '24 hours';
          
            -- Detect bulk W-2 access
            SELECT user_id, COUNT(*) as w2_access_count
            FROM adp_audit_log
            WHERE action = 'w2_view'
            AND timestamp > NOW() - INTERVAL '1 hour'
            GROUP BY user_id
            HAVING COUNT(*) > 10;

