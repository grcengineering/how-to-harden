---
layout: default
title: Home
---

{% assign pack_count = 0 %}
{% for guide in site.guides %}
  {% assign pd = site.data.packs[guide.slug] %}
  {% if pd %}{% assign pack_count = pack_count | plus: 1 %}{% endif %}
{% endfor %}

<section class="hero">
  <div class="container">
    <h1>How to Harden</h1>
    <p class="tagline">Open-source SaaS security hardening guides for supply chain defense. Protect your organization from third-party breaches.</p>

    <div class="hero-stats">
      <div class="stat">
        <div class="stat-value">{{ site.guides.size }}</div>
        <div class="stat-label">Hardening Guides</div>
      </div>
      <div class="stat">
        <div class="stat-value">7</div>
        <div class="stat-label">SaaS Categories</div>
      </div>
      <div class="stat">
        <div class="stat-value">{{ pack_count }}</div>
        <div class="stat-label">Code Packs</div>
      </div>
    </div>
  </div>
</section>

<div class="floating-bar" id="floating-bar">
  <div class="floating-bar-inner">
    <div class="floating-search">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="11" cy="11" r="8"></circle>
        <path d="m21 21-4.35-4.35"></path>
      </svg>
      <input type="text" id="search" placeholder="Search guides...">
    </div>
    <div class="floating-filters">
      <button class="filter-btn sort-btn filter-active" id="sort-btn" aria-label="Sort A to Z">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 5h10M11 9h7M11 13h4M3 17l4 4 4-4M7 3v18"></path></svg>
        A-Z
      </button>
      <div class="view-toggle">
        <button class="view-btn active" data-view="card" aria-label="Card view">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect></svg>
        </button>
        <button class="view-btn" data-view="list" aria-label="List view">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg>
        </button>
      </div>

      <div class="filter-dropdown" id="filter-category">
        <button class="filter-btn">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect></svg>
          System Type
          <svg class="chevron" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg>
        </button>
        <div class="filter-dropdown-menu">
          <label class="filter-option"><input type="radio" name="category" value="all" checked> All Types</label>
          <label class="filter-option"><input type="radio" name="category" value="identity"> <span class="dot dot-identity"></span> Identity</label>
          <label class="filter-option"><input type="radio" name="category" value="security"> <span class="dot dot-security"></span> Security</label>
          <label class="filter-option"><input type="radio" name="category" value="devops"> <span class="dot dot-devops"></span> DevOps</label>
          <label class="filter-option"><input type="radio" name="category" value="data"> <span class="dot dot-data"></span> Data</label>
          <label class="filter-option"><input type="radio" name="category" value="productivity"> <span class="dot dot-productivity"></span> Productivity</label>
          <label class="filter-option"><input type="radio" name="category" value="hr"> <span class="dot dot-hr"></span> HR/Finance</label>
          <label class="filter-option"><input type="radio" name="category" value="marketing"> <span class="dot dot-marketing"></span> Marketing</label>
        </div>
      </div>

      <div class="filter-dropdown" id="filter-status">
        <button class="filter-btn">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>
          Guide Status
          <svg class="chevron" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg>
        </button>
        <div class="filter-dropdown-menu">
          <label class="filter-option"><input type="radio" name="status" value="all" checked> All Status</label>
          <label class="filter-option"><input type="radio" name="status" value="ai-drafted"> <span class="dot dot-drafted"></span> AI Drafted</label>
          <label class="filter-option"><input type="radio" name="status" value="human-reviewed"> <span class="dot dot-reviewed"></span> Reviewed</label>
          <label class="filter-option"><input type="radio" name="status" value="human-verified"> <span class="dot dot-verified"></span> Verified</label>
        </div>
      </div>

      <div class="filter-dropdown" id="filter-packs">
        <button class="filter-btn">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="16 18 22 12 16 6"></polyline><polyline points="8 6 2 12 8 18"></polyline></svg>
          Code Packs
          <svg class="chevron" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg>
        </button>
        <div class="filter-dropdown-menu">
          <label class="filter-option"><input type="radio" name="packs" value="all" checked> All Guides</label>
          <label class="filter-option"><input type="radio" name="packs" value="has-pack"> With Code Pack</label>
        </div>
      </div>
    </div>
  </div>
</div>

<section class="guides-section" id="guides">
  <div class="container">

    <div class="guides-grid" id="guides-grid">
      {% for guide in site.guides %}
      {% assign cat = guide.category | downcase %}
      {% if cat contains "identity" or cat contains "iam" or cat contains "iga" %}
        {% assign data_cat = "identity" %}
        {% assign cat_label = "Identity" %}
      {% elsif cat contains "security" or cat contains "pam" or cat contains "secrets" %}
        {% assign data_cat = "security" %}
        {% assign cat_label = "Security" %}
      {% elsif cat contains "devops" or cat contains "ci/cd" or cat contains "iac" or cat contains "container" or cat contains "hosting" or cat contains "developer" %}
        {% assign data_cat = "devops" %}
        {% assign cat_label = "DevOps" %}
      {% elsif cat contains "data" or cat contains "analytics" or cat contains "observability" or cat contains "storage" %}
        {% assign data_cat = "data" %}
        {% assign cat_label = "Data" %}
      {% elsif cat contains "collaboration" or cat contains "productivity" or cat contains "itsm" or cat contains "support" or cat contains "communication" or cat contains "business" or cat contains "erp" or cat contains "automation" %}
        {% assign data_cat = "productivity" %}
        {% assign cat_label = "Productivity" %}
      {% elsif cat contains "hr" or cat contains "payroll" or cat contains "finance" %}
        {% assign data_cat = "hr" %}
        {% assign cat_label = "HR/Finance" %}
      {% elsif cat contains "marketing" or cat contains "crm" or cat contains "ai" %}
        {% assign data_cat = "marketing" %}
        {% assign cat_label = "Marketing" %}
      {% else %}
        {% assign data_cat = "security" %}
        {% assign cat_label = "Security" %}
      {% endif %}
      {% if guide.maturity == "human-reviewed" %}
        {% assign review_status = "human-reviewed" %}
        {% assign status_class = "status-reviewed" %}
        {% assign status_label = "Reviewed" %}
      {% elsif guide.maturity == "human-verified" %}
        {% assign review_status = "human-verified" %}
        {% assign status_class = "status-verified" %}
        {% assign status_label = "Verified" %}
      {% else %}
        {% assign review_status = "ai-drafted" %}
        {% assign status_class = "status-draft" %}
        {% assign status_label = "AI Drafted" %}
      {% endif %}
      {% assign has_pack = false %}
      {% assign pack_data = site.data.packs[guide.slug] %}
      {% if pack_data %}{% assign has_pack = true %}{% endif %}
      <div class="guide-card" data-category="{{ data_cat }}" data-name="{{ guide.slug }}" data-reviewed="{{ review_status }}" data-has-pack="{{ has_pack }}">
        <div class="guide-card-header">
          <h3><a href="{{ guide.url | relative_url }}">{{ guide.vendor }}</a></h3>
          <span class="status-badge {{ status_class }}">
            {% if review_status == "ai-drafted" %}
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
              <line x1="12" y1="9" x2="12" y2="13"></line>
              <circle cx="12" cy="17" r="1" fill="currentColor"></circle>
            </svg>
            {% elsif review_status == "human-reviewed" %}
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
              <circle cx="12" cy="12" r="3"></circle>
            </svg>
            {% else %}
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="20 6 9 17 4 12"></polyline>
            </svg>
            {% endif %}
            {{ status_label }}
          </span>
        </div>
        <p class="guide-card-description">{{ guide.description }}</p>
        <div class="guide-card-meta">
          <span class="category-tag category-{{ data_cat }}">{{ cat_label }}</span>
          {% if has_pack %}
          <span class="pack-badge">
            <span class="pack-badge-text">&lt;/&gt; Code Pack</span>
          </span>
          {% endif %}
        </div>
      </div>
      {% endfor %}

    </div>
  </div>
</section>

<script>
// Filter, sort, and view functionality
document.addEventListener('DOMContentLoaded', function() {
  const searchInput = document.getElementById('search');
  const sortBtn = document.getElementById('sort-btn');
  const viewButtons = document.querySelectorAll('.view-btn');
  const guidesGrid = document.getElementById('guides-grid');
  const guideCards = document.querySelectorAll('.guide-card');
  const dropdowns = document.querySelectorAll('.filter-dropdown');

  // State
  const originalOrder = Array.from(guideCards);
  let sortDirection = 'az'; // default to A-Z
  let activeCategory = 'all';
  let activeStatus = 'all';
  let activePack = 'all';

  // --- Dropdown toggle logic ---
  dropdowns.forEach(function(dd) {
    var btn = dd.querySelector('.filter-btn');
    var menu = dd.querySelector('.filter-dropdown-menu');
    // Prevent touchstart from reaching the outside-close handler
    dd.addEventListener('touchstart', function(e) { e.stopPropagation(); }, { passive: false });

    btn.addEventListener('click', function(e) {
      e.preventDefault();
      e.stopPropagation();
      var wasOpen = dd.classList.contains('open');
      closeAllDropdowns();
      if (!wasOpen) {
        dd.classList.add('open');
      }
    });
    // Handle filter option selection
    function handleSelection(radio) {
      var filterName = radio.name;
      var val = radio.value;
      if (filterName === 'category') activeCategory = val;
      else if (filterName === 'status') activeStatus = val;
      else if (filterName === 'packs') activePack = val;
      // Update checked class on all options (fallback for :has())
      menu.querySelectorAll('.filter-option').forEach(function(opt) {
        opt.classList.toggle('option-checked', opt.querySelector('input').checked);
      });
      updateDropdownLabel(dd, filterName, val);
      dd.classList.remove('open');
      filterGuides();
    }
    // Listen for radio change (works in most browsers)
    menu.querySelectorAll('input[type="radio"]').forEach(function(radio) {
      radio.addEventListener('change', function() { handleSelection(this); });
    });
    // Safari fallback: tap on label may not fire radio change event
    menu.querySelectorAll('.filter-option').forEach(function(label) {
      label.addEventListener('click', function(e) {
        var radio = this.querySelector('input[type="radio"]');
        if (radio && !radio.checked) {
          radio.checked = true;
          handleSelection(radio);
        }
      });
    });
    // Set initial checked class on load
    menu.querySelectorAll('.filter-option').forEach(function(opt) {
      opt.classList.toggle('option-checked', opt.querySelector('input').checked);
    });
  });

  function closeAllDropdowns() {
    dropdowns.forEach(function(dd) { dd.classList.remove('open'); });
  }

  // Close dropdowns on outside click/touch (iOS Safari needs touchstart)
  function handleOutsideClick(e) {
    if (!e.target.closest('.filter-dropdown')) closeAllDropdowns();
  }
  document.addEventListener('click', handleOutsideClick);
  document.addEventListener('touchstart', handleOutsideClick, { passive: true });

  // Update button text when a non-default option is selected
  function updateDropdownLabel(dd, filterName, val) {
    var btn = dd.querySelector('.filter-btn');
    if (val === 'all') {
      btn.classList.remove('filter-active');
    } else {
      btn.classList.add('filter-active');
    }
  }

  // --- Sort toggle (default: A-Z, tap toggles to Z-A) ---
  sortBtn.addEventListener('click', function() {
    if (sortDirection === 'az') {
      sortDirection = 'za';
      sortBtn.querySelector('svg:first-child').style.transform = 'scaleY(-1)';
      sortBtn.childNodes[sortBtn.childNodes.length - 1].textContent = 'Z-A';
    } else {
      sortDirection = 'az';
      sortBtn.querySelector('svg:first-child').style.transform = '';
      sortBtn.childNodes[sortBtn.childNodes.length - 1].textContent = 'A-Z';
    }
    sortBtn.classList.add('filter-active');
    sortGuides();
  });

  function filterGuides() {
    const searchTerm = searchInput.value.toLowerCase();

    guideCards.forEach(card => {
      const name = card.dataset.name.toLowerCase();
      const category = card.dataset.category;
      const reviewed = card.dataset.reviewed;
      const hasPack = card.dataset.hasPack;
      const title = card.querySelector('h3').textContent.toLowerCase();
      const desc = card.querySelector('.guide-card-description').textContent.toLowerCase();

      const matchesSearch = !searchTerm || name.includes(searchTerm) || title.includes(searchTerm) || desc.includes(searchTerm);
      const matchesCategory = activeCategory === 'all' || category === activeCategory;
      const matchesReview = activeStatus === 'all' || reviewed === activeStatus;
      const matchesPack = activePack === 'all' || hasPack === 'true';

      card.style.display = matchesSearch && matchesCategory && matchesReview && matchesPack ? '' : 'none';
    });
  }

  function sortGuides() {
    const cardsArray = Array.from(guideCards);

    if (sortDirection === 'default') {
      originalOrder.forEach(card => guidesGrid.appendChild(card));
    } else {
      cardsArray.sort((a, b) => {
        const nameA = a.querySelector('h3').textContent.toLowerCase();
        const nameB = b.querySelector('h3').textContent.toLowerCase();
        return sortDirection === 'az' ? nameA.localeCompare(nameB) : nameB.localeCompare(nameA);
      });
      cardsArray.forEach(card => guidesGrid.appendChild(card));
    }
    filterGuides();
  }

  function setView(view) {
    guidesGrid.classList.toggle('list-view', view === 'list');
  }

  searchInput.addEventListener('input', function() {
    filterGuides();
    // On mobile, scroll to guides so results are visible
    if (window.innerWidth <= 640) {
      var guidesEl = document.getElementById('guides');
      if (guidesEl) guidesEl.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }
  });

  viewButtons.forEach(function(btn) {
    btn.addEventListener('click', function() {
      viewButtons.forEach(function(b) { b.classList.remove('active'); });
      this.classList.add('active');
      setView(this.dataset.view);
    });
  });

  // Make entire guide card clickable
  guideCards.forEach(function(card) {
    card.addEventListener('click', function(e) {
      if (e.target.tagName === 'A' || e.target.closest('a')) return;
      var link = this.querySelector('h3 a');
      if (link) link.click();
    });
  });

  // Sort A-Z on initial load
  sortGuides();
});
</script>
